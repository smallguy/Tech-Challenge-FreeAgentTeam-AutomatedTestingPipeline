# 修复代码生成提示词（实例ID：django__django-13162）
## 代码仓库
django/django

## 原始问题描述
Improve default name of merge migrations.
Description
	
Currently, merge migrations filenames are created with a timestamp. For example:
0003_merge_20160102_0304.py
This name is more opaque than necessary. When one reads it, it isn't immediately clear which migrations were merged. One must inspect the file to find that information.
Instead, I suggest the default filename should be created by combining the files being merged. This way, it includes the information without requiring one to inspect the file. This information is also useful in the migrate command's output. As it is most likely to merge two migrations files, this should remain a reasonable length.
For example:
0003_merge_0002_conflicting_second_0002_second.py
If preferable, we could decide to join the names in other ways too. For example, separate names by __ (two underscores) or exclude prefix numbers. To start, I'll go with the easiest approach unless there is strong preference for a different naming scheme.


## 参考黄金补丁（正确的修复方案）
diff --git a/tests/migrations/test_commands.py b/tests/migrations/test_commands.py
--- a/tests/migrations/test_commands.py
+++ b/tests/migrations/test_commands.py
@@ -1208,12 +1208,27 @@ def test_makemigrations_interactive_accept(self):
                 self.assertTrue(os.path.exists(merge_file))
             self.assertIn("Created new merge migration", out.getvalue())
 
+    def test_makemigrations_default_merge_name(self):
+        out = io.StringIO()
+        with self.temporary_migration_module(
+            module='migrations.test_migrations_conflict'
+        ) as migration_dir:
+            call_command('makemigrations', 'migrations', merge=True, interactive=False, stdout=out)
+            merge_file = os.path.join(
+                migration_dir,
+                '0003_merge_0002_conflicting_second_0002_second.py',
+            )
+            self.assertIs(os.path.exists(merge_file), True)
+        self.assertIn('Created new merge migration %s' % merge_file, out.getvalue())
+
     @mock.patch('django.db.migrations.utils.datetime')
-    def test_makemigrations_default_merge_name(self, mock_datetime):
+    def test_makemigrations_auto_merge_name(self, mock_datetime):
         mock_datetime.datetime.now.return_value = datetime.datetime(2016, 1, 2, 3, 4)
         with mock.patch('builtins.input', mock.Mock(return_value='y')):
             out = io.StringIO()
-            with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
+            with self.temporary_migration_module(
+                module='migrations.test_migrations_conflict_long_name'
+            ) as migration_dir:
                 call_command("makemigrations", "migrations", merge=True, interactive=True, stdout=out)
                 merge_file = os.path.join(migration_dir, '0003_merge_20160102_0304.py')
                 self.assertTrue(os.path.exists(merge_file))
diff --git a/tests/migrations/test_migrations_conflict_long_name/0001_initial.py b/tests/migrations/test_migrations_conflict_long_name/0001_initial.py
new file mode 100644
--- /dev/null
+++ b/tests/migrations/test_migrations_conflict_long_name/0001_initial.py
@@ -0,0 +1,14 @@
+from django.db import migrations, models
+
+
+class Migration(migrations.Migration):
+    initial = True
+
+    operations = [
+        migrations.CreateModel(
+            'Author',
+            [
+                ('id', models.AutoField(primary_key=True)),
+            ],
+        ),
+    ]
diff --git a/tests/migrations/test_migrations_conflict_long_name/0002_conflicting_second_migration_with_long_name.py b/tests/migrations/test_migrations_conflict_long_name/0002_conflicting_second_migration_with_long_name.py
new file mode 100644
--- /dev/null
+++ b/tests/migrations/test_migrations_conflict_long_name/0002_conflicting_second_migration_with_long_name.py
@@ -0,0 +1,14 @@
+from django.db import migrations, models
+
+
+class Migration(migrations.Migration):
+    dependencies = [('migrations', '0001_initial')]
+
+    operations = [
+        migrations.CreateModel(
+            'SomethingElse',
+            [
+                ('id', models.AutoField(primary_key=True)),
+            ],
+        ),
+    ]
diff --git a/tests/migrations/test_migrations_conflict_long_name/0002_second.py b/tests/migrations/test_migrations_conflict_long_name/0002_second.py
new file mode 100644
--- /dev/null
+++ b/tests/migrations/test_migrations_conflict_long_name/0002_second.py
@@ -0,0 +1,14 @@
+from django.db import migrations, models
+
+
+class Migration(migrations.Migration):
+    dependencies = [('migrations', '0001_initial')]
+
+    operations = [
+        migrations.CreateModel(
+            'Something',
+            [
+                ('id', models.AutoField(primary_key=True)),
+            ],
+        ),
+    ]
diff --git a/tests/migrations/test_migrations_conflict_long_name/__init__.py b/tests/migrations/test_migrations_conflict_long_name/__init__.py
new file mode 100644