# 修复代码生成提示词（实例ID：django__django-11096）
## 代码仓库
django/django

## 原始问题描述
Support the use of admin_order_field on properties in the admin.
Description
	
The ModelAdmin class allows to specify properties from the model in list_display.
Normally non-fields cannot be sorted. This can be changed by setting admin_order_field. This doesn't work on properties, while it is possible to do so with short_description.
The ​code that checks for short_description checks if it handles a property and returns attr.fget.short_description if available.
The files that check for admin_order_field do not handle the case that it might be a property.
The relevant files are probably:
django/contrib/admin/views/main.py (​GitHub)
django/contrib/admin/templatetags/admin_list.py (​ GitHub)


## 参考黄金补丁（正确的修复方案）
diff --git a/tests/admin_views/admin.py b/tests/admin_views/admin.py
--- a/tests/admin_views/admin.py
+++ b/tests/admin_views/admin.py
@@ -104,7 +104,7 @@ class ArticleAdmin(admin.ModelAdmin):
     list_display = (
         'content', 'date', callable_year, 'model_year', 'modeladmin_year',
         'model_year_reversed', 'section', lambda obj: obj.title,
-        'order_by_expression',
+        'order_by_expression', 'model_property_year',
     )
     list_editable = ('section',)
     list_filter = ('date', 'section')
diff --git a/tests/admin_views/models.py b/tests/admin_views/models.py
--- a/tests/admin_views/models.py
+++ b/tests/admin_views/models.py
@@ -55,6 +55,11 @@ def model_year_reversed(self):
     model_year_reversed.admin_order_field = '-date'
     model_year_reversed.short_description = ''
 
+    def property_year(self):
+        return self.date.year
+    property_year.admin_order_field = 'date'
+    model_property_year = property(property_year)
+
 
 class Book(models.Model):
     """
diff --git a/tests/admin_views/tests.py b/tests/admin_views/tests.py
--- a/tests/admin_views/tests.py
+++ b/tests/admin_views/tests.py
@@ -344,6 +344,25 @@ def test_change_list_sorting_callable(self):
             "Results of sorting on callable are out of order."
         )
 
+    def test_change_list_sorting_property(self):
+        """
+        Sort on a list_display field that is a property (column 10 is
+        a property in Article model).
+        """
+        response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': 10})
+        self.assertContentBefore(
+            response,
+            'Oldest content',
+            'Middle content',
+            'Results of sorting on property are out of order.',
+        )
+        self.assertContentBefore(
+            response,
+            'Middle content',
+            'Newest content',
+            'Results of sorting on property are out of order.',
+        )
+
     def test_change_list_sorting_callable_query_expression(self):
         """
         Query expressions may be used for admin_order_field. (column 9 is