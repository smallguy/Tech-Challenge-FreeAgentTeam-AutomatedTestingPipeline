# 修复代码生成提示词（实例ID：django__django-16750）
## 代码仓库
django/django

## 原始问题描述
Annotating with Chr raises ValueError
Description
	 
		(last modified by Jacob Walls)
	 
>>> Author.objects.annotate(first_letter=Chr(Value(77)))
File "/Users/.../.../.venv/lib/python3.9/site-packages/django/db/models/expressions.py", line 369, in <lambda>
	else int(value)
ValueError: invalid literal for int() with base 10: 'M'
I'm suggesting in Chr we can set output_field = CharField() to prevent this.


## 参考黄金补丁（正确的修复方案）
diff --git a/tests/db_functions/text/test_chr.py b/tests/db_functions/text/test_chr.py
--- a/tests/db_functions/text/test_chr.py
+++ b/tests/db_functions/text/test_chr.py
@@ -1,4 +1,4 @@
-from django.db.models import IntegerField
+from django.db.models import F, IntegerField
 from django.db.models.functions import Chr, Left, Ord
 from django.test import TestCase
 from django.test.utils import register_lookup
@@ -37,3 +37,13 @@ def test_transform(self):
                 authors.exclude(name_code_point__chr=Chr(ord("J"))),
                 [self.elena, self.rhonda],
             )
+
+    def test_annotate(self):
+        authors = Author.objects.annotate(
+            first_initial=Left("name", 1),
+            initial_chr=Chr(ord("J")),
+        )
+        self.assertSequenceEqual(
+            authors.filter(first_initial=F("initial_chr")),
+            [self.john],
+        )