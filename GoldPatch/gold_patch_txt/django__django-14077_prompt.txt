# 修复代码生成提示词（实例ID：django__django-14077）
## 代码仓库
django/django

## 原始问题描述
QuerySet.values()/values_list() with JSONField returns integers instead of booleans on SQLite.
Description
	 
		(last modified by Matthew Cornell)
	 
I have a model with a JSONField:
class PredictionData(models.Model):
	data = models.JSONField()
One of the rows contains this dict: {'value': True}.
I'm querying the model's JSON using 'data__value':
PredictionData.objects.values_list('data', 'data__value')
I get correct results for postgres (a boolean) but incorrect for sqlite3 (an int). For this query, sqlite3 wrongly returns:
({'value': True}, 1)
whereas postgres correctly returns
({'value': True}, True)
Same behavior with False/0.
versions:
Python 3.9.1
sqlite3.sqlite_version # '3.33.0'
django.version # '3.1.7'


## 参考黄金补丁（正确的修复方案）
diff --git a/tests/model_fields/test_jsonfield.py b/tests/model_fields/test_jsonfield.py
--- a/tests/model_fields/test_jsonfield.py
+++ b/tests/model_fields/test_jsonfield.py
@@ -277,9 +277,10 @@ def setUpTestData(cls):
                 'i': False,
                 'j': None,
                 'k': {'l': 'm'},
-                'n': [None],
+                'n': [None, True, False],
                 'o': '"quoted"',
                 'p': 4.2,
+                'r': {'s': True, 't': False},
             },
             [1, [2]],
             {'k': True, 'l': False, 'foo': 'bax'},
@@ -538,7 +539,7 @@ def test_contains(self):
             ([1, [2]], [self.objs[5]]),
             ([1], [self.objs[5]]),
             ([[2]], [self.objs[5]]),
-            ({'n': [None]}, [self.objs[4]]),
+            ({'n': [None, True, False]}, [self.objs[4]]),
             ({'j': None}, [self.objs[4]]),
         ]
         for value, expected in tests:
@@ -779,6 +780,8 @@ def test_key_in(self):
             ('value__bar__in', [['foo', 'bar']], [self.objs[7]]),
             ('value__bar__in', [['foo', 'bar'], ['a']], [self.objs[7]]),
             ('value__bax__in', [{'foo': 'bar'}, {'a': 'b'}], [self.objs[7]]),
+            ('value__h__in', [True, 'foo'], [self.objs[4]]),
+            ('value__i__in', [False, 'foo'], [self.objs[4]]),
         ]
         for lookup, value, expected in tests:
             with self.subTest(lookup=lookup, value=value):
@@ -797,13 +800,24 @@ def test_key_values(self):
             ('value__i', False),
             ('value__j', None),
             ('value__k', {'l': 'm'}),
-            ('value__n', [None]),
+            ('value__n', [None, True, False]),
             ('value__p', 4.2),
+            ('value__r', {'s': True, 't': False}),
         ]
         for lookup, expected in tests:
             with self.subTest(lookup=lookup):
                 self.assertEqual(qs.values_list(lookup, flat=True).get(), expected)
 
+    def test_key_values_boolean(self):
+        qs = NullableJSONModel.objects.filter(value__h=True, value__i=False)
+        tests = [
+            ('value__h', True),
+            ('value__i', False),
+        ]
+        for lookup, expected in tests:
+            with self.subTest(lookup=lookup):
+                self.assertIs(qs.values_list(lookup, flat=True).get(), expected)
+
     @skipUnlessDBFeature('supports_json_field_contains')
     def test_key_contains(self):
         self.assertIs(NullableJSONModel.objects.filter(value__foo__contains='ar').exists(), False)