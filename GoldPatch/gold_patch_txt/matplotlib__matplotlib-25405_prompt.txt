# 修复代码生成提示词（实例ID：matplotlib__matplotlib-25405）
## 代码仓库
matplotlib/matplotlib

## 原始问题描述
[Bug]: LogLocator with subs argument fragile.
### Bug summary

Logarithmic tick markers do not appear if the y-axis scales a sufficient range, with the `subs` keyword argument of `ticker.LogLocator` set to non-trivial values.


### Code for reproduction

```python
import matplotlib.pyplot as plt
import matplotlib.ticker
import numpy as np

ll = matplotlib.ticker.LogLocator(subs=(1, 2, 5))

### The following code produces a plot with y-axis ticks at the expected locations.

fig, ax = plt.subplots()
x = np.arange(8)
plt.semilogy(x, 10 ** x)
ax.yaxis.set_major_locator(ll)
ax.yaxis.set_minor_locator(ll)
plt.title("Good Plot")
plt.show()

### The following code produces a plot with no y-axis ticks, which is unexpected and undesired.

fig, ax = plt.subplots()
x = np.arange(9)  # The only change is this line
plt.semilogy(x, 10 ** x)
ax.yaxis.set_major_locator(ll)
ax.yaxis.set_minor_locator(ll)
plt.title("Bad Plot")
plt.show()

### The problem is isolated to here, which returns correct values in the first case, but np.array([]) in the second case:
print(ll.tick_values(1, 1e7))
print(ll.tick_values(1, 1e8))
```


### Actual outcome

![image](https://user-images.githubusercontent.com/6295985/193890350-8914dcd1-af5a-4466-9e43-b21396352a56.png)

![image](https://user-images.githubusercontent.com/6295985/193890374-0f9c1f65-e89a-40b1-a095-2367b68a39fd.png)



### Expected outcome

I expect to see ticks in both cases, as appears in the "Good Plot".

### Additional information

The problem is isolated to `ticker.LogLocator.tick_values()`. This returns correct values in the first case (e.g., `np.array([1.e-01 2.e-01 5.e-01 1.e+00 2.e+00 5.e+00 1.e+01 2.e+01 5.e+01 1.e+02
 2.e+02 5.e+02])`), but `np.array([])` in the second case.

### Operating system

Windows

### Matplotlib Version

3.5.2

### Matplotlib Backend

module://backend_interagg

### Python version

3.9.13

### Jupyter version

_No response_

### Installation

conda
[Bug]: LogLocator with subs argument fragile.
### Bug summary

Logarithmic tick markers do not appear if the y-axis scales a sufficient range, with the `subs` keyword argument of `ticker.LogLocator` set to non-trivial values.


### Code for reproduction

```python
import matplotlib.pyplot as plt
import matplotlib.ticker
import numpy as np

ll = matplotlib.ticker.LogLocator(subs=(1, 2, 5))

### The following code produces a plot with y-axis ticks at the expected locations.

fig, ax = plt.subplots()
x = np.arange(8)
plt.semilogy(x, 10 ** x)
ax.yaxis.set_major_locator(ll)
ax.yaxis.set_minor_locator(ll)
plt.title("Good Plot")
plt.show()

### The following code produces a plot with no y-axis ticks, which is unexpected and undesired.

fig, ax = plt.subplots()
x = np.arange(9)  # The only change is this line
plt.semilogy(x, 10 ** x)
ax.yaxis.set_major_locator(ll)
ax.yaxis.set_minor_locator(ll)
plt.title("Bad Plot")
plt.show()

### The problem is isolated to here, which returns correct values in the first case, but np.array([]) in the second case:
print(ll.tick_values(1, 1e7))
print(ll.tick_values(1, 1e8))
```


### Actual outcome

![image](https://user-images.githubusercontent.com/6295985/193890350-8914dcd1-af5a-4466-9e43-b21396352a56.png)

![image](https://user-images.githubusercontent.com/6295985/193890374-0f9c1f65-e89a-40b1-a095-2367b68a39fd.png)



### Expected outcome

I expect to see ticks in both cases, as appears in the "Good Plot".

### Additional information

The problem is isolated to `ticker.LogLocator.tick_values()`. This returns correct values in the first case (e.g., `np.array([1.e-01 2.e-01 5.e-01 1.e+00 2.e+00 5.e+00 1.e+01 2.e+01 5.e+01 1.e+02
 2.e+02 5.e+02])`), but `np.array([])` in the second case.

### Operating system

Windows

### Matplotlib Version

3.5.2

### Matplotlib Backend

module://backend_interagg

### Python version

3.9.13

### Jupyter version

_No response_

### Installation

conda


## 参考黄金补丁（正确的修复方案）
diff --git a/lib/matplotlib/tests/test_ticker.py b/lib/matplotlib/tests/test_ticker.py
--- a/lib/matplotlib/tests/test_ticker.py
+++ b/lib/matplotlib/tests/test_ticker.py
@@ -239,6 +239,26 @@ def test_set_params(self):
         assert loc._base == 4
         assert list(loc._subs) == [2.0]
 
+    def test_tick_values_correct(self):
+        ll = mticker.LogLocator(subs=(1, 2, 5))
+        test_value = np.array([1.e-01, 2.e-01, 5.e-01, 1.e+00, 2.e+00, 5.e+00,
+                               1.e+01, 2.e+01, 5.e+01, 1.e+02, 2.e+02, 5.e+02,
+                               1.e+03, 2.e+03, 5.e+03, 1.e+04, 2.e+04, 5.e+04,
+                               1.e+05, 2.e+05, 5.e+05, 1.e+06, 2.e+06, 5.e+06,
+                               1.e+07, 2.e+07, 5.e+07, 1.e+08, 2.e+08, 5.e+08])
+        assert_almost_equal(ll.tick_values(1, 1e7), test_value)
+
+    def test_tick_values_not_empty(self):
+        mpl.rcParams['_internal.classic_mode'] = False
+        ll = mticker.LogLocator(subs=(1, 2, 5))
+        test_value = np.array([1.e-01, 2.e-01, 5.e-01, 1.e+00, 2.e+00, 5.e+00,
+                               1.e+01, 2.e+01, 5.e+01, 1.e+02, 2.e+02, 5.e+02,
+                               1.e+03, 2.e+03, 5.e+03, 1.e+04, 2.e+04, 5.e+04,
+                               1.e+05, 2.e+05, 5.e+05, 1.e+06, 2.e+06, 5.e+06,
+                               1.e+07, 2.e+07, 5.e+07, 1.e+08, 2.e+08, 5.e+08,
+                               1.e+09, 2.e+09, 5.e+09])
+        assert_almost_equal(ll.tick_values(1, 1e8), test_value)
+
 
 class TestNullLocator:
     def test_set_params(self):