# 修复代码生成提示词（实例ID：django__django-13115）
## 代码仓库
django/django

## 原始问题描述
Add errors when UniqueConstraint.deferrable is combined with index specific parameters
Description
	
UniqueConstraint should throw an error when deferrable is combined with parameters which require the usage of an explicit unique index through CREATE UNIQUE INDEX. This was missed when UniqueConstraint.include and UniqueConstraint.opclasses was added. We should also add documentation about this incompatibility.


## 参考黄金补丁（正确的修复方案）
diff --git a/tests/constraints/tests.py b/tests/constraints/tests.py
--- a/tests/constraints/tests.py
+++ b/tests/constraints/tests.py
@@ -406,6 +406,26 @@ def test_deferrable_with_condition(self):
                 deferrable=models.Deferrable.DEFERRED,
             )
 
+    def test_deferrable_with_include(self):
+        message = 'UniqueConstraint with include fields cannot be deferred.'
+        with self.assertRaisesMessage(ValueError, message):
+            models.UniqueConstraint(
+                fields=['name'],
+                name='name_inc_color_color_unique',
+                include=['color'],
+                deferrable=models.Deferrable.DEFERRED,
+            )
+
+    def test_deferrable_with_opclasses(self):
+        message = 'UniqueConstraint with opclasses cannot be deferred.'
+        with self.assertRaisesMessage(ValueError, message):
+            models.UniqueConstraint(
+                fields=['name'],
+                name='name_text_pattern_ops_unique',
+                opclasses=['text_pattern_ops'],
+                deferrable=models.Deferrable.DEFERRED,
+            )
+
     def test_invalid_defer_argument(self):
         message = 'UniqueConstraint.deferrable must be a Deferrable instance.'
         with self.assertRaisesMessage(ValueError, message):