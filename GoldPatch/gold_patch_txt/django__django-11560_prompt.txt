# 修复代码生成提示词（实例ID：django__django-11560）
## 代码仓库
django/django

## 原始问题描述
Raise ValueError in Extract lookups that don't work properly with DurationField.
Description
	
Lookups on ExtractYear on a DurationField fails because ExtractYear has an optimisation where it compares the source date with a range of dates.
class MyModel(models.Model):
	duration = models.DurationField()
MyModel.objects.annotate(year=ExtractYear('duration')).filter(year__gt=1)
The queryset generated looks like
SELECT * FROM mymodel WHERE duration > '0001-01-01'
and it fails because interval are not comparable with dates


## 参考黄金补丁（正确的修复方案）
diff --git a/tests/db_functions/datetime/test_extract_trunc.py b/tests/db_functions/datetime/test_extract_trunc.py
--- a/tests/db_functions/datetime/test_extract_trunc.py
+++ b/tests/db_functions/datetime/test_extract_trunc.py
@@ -273,6 +273,13 @@ def test_extract_duration_without_native_duration_field(self):
         with self.assertRaisesMessage(ValueError, msg):
             list(DTModel.objects.annotate(extracted=Extract('duration', 'second')))
 
+    def test_extract_duration_unsupported_lookups(self):
+        msg = "Cannot extract component '%s' from DurationField 'duration'."
+        for lookup in ('year', 'iso_year', 'month', 'week', 'week_day', 'quarter'):
+            with self.subTest(lookup):
+                with self.assertRaisesMessage(ValueError, msg % lookup):
+                    DTModel.objects.annotate(extracted=Extract('duration', lookup))
+
     def test_extract_year_func(self):
         start_datetime = datetime(2015, 6, 15, 14, 30, 50, 321)
         end_datetime = datetime(2016, 6, 15, 14, 10, 50, 123)