# 修复代码生成提示词（实例ID：sympy__sympy-17150）
## 代码仓库
sympy/sympy

## 原始问题描述
Incorrect extraction of base powers in log class
Evaluating `log(Rational(408,499),2)` produces `zoo`, but it should produce `log(Rational(51,499))/log(2) + 3`.

The issue seems to originate around line `531` in `sympy/functions/elementary/exponential.py` during extraction of base powers, where `arg // den` is evaluated to `0` but should evaluate to `Rational(51,499)`:

                    if den.is_Integer:
                        return n + log(arg // den) / log(base)
                    else:
                        return n + log(arg / den) / log(base)

I would suggest to fix the issue by removing the `if` conditional and keeping the else branch (seems like a case of premature optimization). Alternatively, this also seems to fix the issue:

                    if arg.is_Integer and den.is_Integer:
                        return n + log(arg // den) / log(base)
                    else:
                        return n + log(arg / den) / log(base)

That said, seeing that this code was not changed recently, the issue may run deeper.



## 参考黄金补丁（正确的修复方案）
diff --git a/sympy/functions/elementary/tests/test_exponential.py b/sympy/functions/elementary/tests/test_exponential.py
--- a/sympy/functions/elementary/tests/test_exponential.py
+++ b/sympy/functions/elementary/tests/test_exponential.py
@@ -212,6 +212,8 @@ def test_log_base():
     assert log(Rational(2, 3), Rational(1, 3)) == -log(2)/log(3) + 1
     assert log(Rational(2, 3), Rational(2, 5)) == \
         log(S(2)/3)/log(S(2)/5)
+    # issue 17148
+    assert log(S(8)/3, 2) == -log(3)/log(2) + 3
 
 
 def test_log_symbolic():