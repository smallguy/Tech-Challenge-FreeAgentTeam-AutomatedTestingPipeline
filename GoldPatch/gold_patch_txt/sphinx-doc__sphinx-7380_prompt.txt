# 修复代码生成提示词（实例ID：sphinx-doc__sphinx-7380）
## 代码仓库
sphinx-doc/sphinx

## 原始问题描述
cpp domain parens in template parameter packs fails
**Describe the bug**
I have C++ code with parentheses in the template parameter list documented as:
```
.. cpp:class:: template <std::integer_sequence<bool, (static_cast<void>(Bs), false)>> foo

    Broken because of parentheses around `static_cast<void>(Bs), false`
```
The same issue comes up if I use a C-style cast:
```
.. cpp:class:: template <std::integer_sequence<bool, (void(Bs), false)>> foo

    Broken because of parentheses around `void(Bs), false`
```

**To Reproduce**
Steps to reproduce the behavior:
```
$ git clone git@github.com:nilsdeppe/sphinx-bugs.git
$ cd ./sphinx-bugs/issue_cast_templates
$ sphinx-build ./ ./build
$ # open build/index.html
```

**Expected behavior**
Using parentheses to nest expressions inside templates works. This is fairly common when expanding parameter packs, e.g.
```cpp
template <bool... Bs>
using flat_any = std::integral_constant<
    bool,
    not std::is_same<
        value_list<bool, Bs...>,
        value_list<bool, (static_cast<void>(Bs), false)...>>::value>;
```

**Your project**
I've set up a simple repo with an example of the issue: https://github.com/nilsdeppe/sphinx-bugs

**Environment info**
- OS: Linux
- Python version: 3.8.2
- Sphinx version: 2.4.4
- Sphinx extensions:  
- Extra tools: 

**Additional context**
The issue appears to be in the cpp domain, unlike #7367 I haven't had any success in diagnosing and fixing this.

I've attached the build output:
[build.tar.gz](https://github.com/sphinx-doc/sphinx/files/4372224/build.tar.gz)





## 参考黄金补丁（正确的修复方案）
diff --git a/tests/test_domain_cpp.py b/tests/test_domain_cpp.py
--- a/tests/test_domain_cpp.py
+++ b/tests/test_domain_cpp.py
@@ -274,6 +274,9 @@ class Config:
     exprCheck('a xor_eq 5', 'eO1aL5E')
     exprCheck('a |= 5', 'oR1aL5E')
     exprCheck('a or_eq 5', 'oR1aL5E')
+    exprCheck('a = {1, 2, 3}', 'aS1ailL1EL2EL3EE')
+    # comma operator
+    exprCheck('a, 5', 'cm1aL5E')
 
     # Additional tests
     # a < expression that starts with something that could be a template
@@ -626,6 +629,12 @@ def test_class_definitions():
           {2: 'I0E7has_varI1TNSt6void_tIDTadN1T3varEEEEE'})
 
 
+    check('class', 'template<typename ...Ts> T<int (*)(Ts)...>',
+          {2: 'IDpE1TIJPFi2TsEEE'})
+    check('class', 'template<int... Is> T<(Is)...>',
+          {2: 'I_DpiE1TIJX(Is)EEE', 3: 'I_DpiE1TIJX2IsEEE'})
+
+
 def test_union_definitions():
     check('union', 'A', {2: "1A"})