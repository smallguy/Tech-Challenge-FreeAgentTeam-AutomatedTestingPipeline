# 修复代码生成提示词（实例ID：django__django-13682）
## 代码仓库
django/django

## 原始问题描述
Improve error messages from forgetting to call .as_view() on a CBV
Description
	 
		(last modified by Angus Holder)
	 
We can detect early-on that the user has forgotten to call .as_view() on their CBV when passing it into path(). For:
urlpatterns = [
	path('home', HomeView)
]
The error currently happens only when you first load the route (rather than when constructing the routes), and looks like 
Internal Server Error: /
Traceback (most recent call last):
 File "C:\Users\Angus\.virtualenvs\django-WBTbdxDv\lib\site-packages\django\core\handlers\exception.py", line 47, in inner
	response = get_response(request)
 File "C:\Users\Angus\.virtualenvs\django-WBTbdxDv\lib\site-packages\django\core\handlers\base.py", line 179, in _get_response
	response = wrapped_callback(request, *callback_args, **callback_kwargs)
TypeError: __init__() takes 1 positional argument but 2 were given
Which is especially hard to work out given that the traceback doesn't even include any of the user's own code, and this is an error that's easy for beginners to run into when first using CBVs.
My PR changes it to fail early, inside the call to django.urls.path(), with a clear error:
URL route 'foo' should pass in 'EmptyCBView.as_view()' instead of 'EmptyCBView'
Pull request: ​https://github.com/django/django/pull/13682


## 参考黄金补丁（正确的修复方案）
diff --git a/tests/check_framework/test_urls.py b/tests/check_framework/test_urls.py
--- a/tests/check_framework/test_urls.py
+++ b/tests/check_framework/test_urls.py
@@ -134,6 +134,16 @@ def test_check_unique_namespaces(self):
         result = check_url_namespaces_unique(None)
         self.assertEqual(result, [])
 
+    @override_settings(ROOT_URLCONF='check_framework.urls.cbv_as_view')
+    def test_check_view_not_class(self):
+        self.assertEqual(check_url_config(None), [
+            Error(
+                "Your URL pattern 'missing_as_view' has an invalid view, pass "
+                "EmptyCBV.as_view() instead of EmptyCBV.",
+                id='urls.E009',
+            ),
+        ])
+
 
 class UpdatedToPathTests(SimpleTestCase):
 
diff --git a/tests/check_framework/urls/cbv_as_view.py b/tests/check_framework/urls/cbv_as_view.py
new file mode 100644
--- /dev/null
+++ b/tests/check_framework/urls/cbv_as_view.py
@@ -0,0 +1,19 @@
+from django.http import HttpResponse
+from django.urls import path
+from django.views import View
+
+
+class EmptyCBV(View):
+    pass
+
+
+class EmptyCallableView:
+    def __call__(self, request, *args, **kwargs):
+        return HttpResponse()
+
+
+urlpatterns = [
+    path('missing_as_view', EmptyCBV),
+    path('has_as_view', EmptyCBV.as_view()),
+    path('callable_class', EmptyCallableView()),
+]
diff --git a/tests/urlpatterns/tests.py b/tests/urlpatterns/tests.py
--- a/tests/urlpatterns/tests.py
+++ b/tests/urlpatterns/tests.py
@@ -5,6 +5,7 @@
 from django.test import SimpleTestCase
 from django.test.utils import override_settings
 from django.urls import NoReverseMatch, Resolver404, path, resolve, reverse
+from django.views import View
 
 from .converters import DynamicConverter
 from .views import empty_view
@@ -141,6 +142,19 @@ def test_invalid_converter(self):
         with self.assertRaisesMessage(ImproperlyConfigured, msg):
             path('foo/<nonexistent:var>/', empty_view)
 
+    def test_invalid_view(self):
+        msg = 'view must be a callable or a list/tuple in the case of include().'
+        with self.assertRaisesMessage(TypeError, msg):
+            path('articles/', 'invalid_view')
+
+    def test_invalid_view_instance(self):
+        class EmptyCBV(View):
+            pass
+
+        msg = 'view must be a callable, pass EmptyCBV.as_view(), not EmptyCBV().'
+        with self.assertRaisesMessage(TypeError, msg):
+            path('foo', EmptyCBV())
+
     def test_whitespace_in_route(self):
         msg = (
             "URL route 'space/<int:num>/extra/<str:%stest>' cannot contain "