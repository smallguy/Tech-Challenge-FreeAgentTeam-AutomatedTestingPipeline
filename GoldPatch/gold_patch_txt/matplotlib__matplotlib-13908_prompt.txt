# 修复代码生成提示词（实例ID：matplotlib__matplotlib-13908）
## 代码仓库
matplotlib/matplotlib

## 原始问题描述
Minor ticklabels are missing at positions of major ticks.
<!--To help us understand and resolve your issue, please fill out the form to the best of your ability.-->
<!--You can feel free to delete the sections that do not apply.-->

### Bug report

**Bug summary**

Minor ticklabels are missing at positions of major ticks.

**Code for reproduction**

```
import numpy as np
import matplotlib.dates as mdates
import matplotlib.pyplot as plt

t = np.arange("2018-11-03", "2018-11-06", dtype="datetime64")
x = np.random.rand(len(t))

fig, ax = plt.subplots()
ax.plot(t,x)

ax.xaxis.set_major_locator(mdates.DayLocator())
ax.xaxis.set_major_formatter(mdates.DateFormatter('\n%a'))

ax.xaxis.set_minor_locator(mdates.HourLocator((0,6,12,18)))
ax.xaxis.set_minor_formatter(mdates.DateFormatter('%H:%M'))

plt.show()
```

**Actual outcome**

The above code run with current master produces

![image](https://user-images.githubusercontent.com/23121882/53986707-332eaf80-411f-11e9-9d0b-4d1df4bae02a.png)

The minor ticklabels showing the `00:00` hours are missing.

**Expected outcome**

The expected outcome would be the same as when running the code with matplotlib 3.0.2 or below:

![image](https://user-images.githubusercontent.com/23121882/53986815-7b4dd200-411f-11e9-84d2-e820792bf6ce.png)

I would expect to see the hours throughout.

**Matplotlib version**
<!--Please specify your platform and versions of the relevant libraries you are using:-->
  * Operating system: Win8
  * Matplotlib version: master
  * Matplotlib backend (`print(matplotlib.get_backend())`): any
  * Python version: 3.6




## 参考黄金补丁（正确的修复方案）
diff --git a/lib/matplotlib/tests/test_ticker.py b/lib/matplotlib/tests/test_ticker.py
--- a/lib/matplotlib/tests/test_ticker.py
+++ b/lib/matplotlib/tests/test_ticker.py
@@ -923,3 +923,49 @@ def minorticksubplot(xminor, yminor, i):
     minorticksubplot(True, False, 2)
     minorticksubplot(False, True, 3)
     minorticksubplot(True, True, 4)
+
+
+@pytest.mark.parametrize('remove_overlapping_locs, expected_num',
+                         ((True, 6),
+                          (None, 6),  # this tests the default
+                          (False, 9)))
+def test_remove_overlap(remove_overlapping_locs, expected_num):
+    import numpy as np
+    import matplotlib.dates as mdates
+
+    t = np.arange("2018-11-03", "2018-11-06", dtype="datetime64")
+    x = np.ones(len(t))
+
+    fig, ax = plt.subplots()
+    ax.plot(t, x)
+
+    ax.xaxis.set_major_locator(mdates.DayLocator())
+    ax.xaxis.set_major_formatter(mdates.DateFormatter('\n%a'))
+
+    ax.xaxis.set_minor_locator(mdates.HourLocator((0, 6, 12, 18)))
+    ax.xaxis.set_minor_formatter(mdates.DateFormatter('%H:%M'))
+    # force there to be extra ticks
+    ax.xaxis.get_minor_ticks(15)
+    if remove_overlapping_locs is not None:
+        ax.xaxis.remove_overlapping_locs = remove_overlapping_locs
+
+    # check that getter/setter exists
+    current = ax.xaxis.remove_overlapping_locs
+    assert (current == ax.xaxis.get_remove_overlapping_locs())
+    plt.setp(ax.xaxis, remove_overlapping_locs=current)
+    new = ax.xaxis.remove_overlapping_locs
+    assert (new == ax.xaxis.remove_overlapping_locs)
+
+    # check that the accessors filter correctly
+    # this is the method that does the actual filtering
+    assert len(ax.xaxis.get_minorticklocs()) == expected_num
+    # these three are derivative
+    assert len(ax.xaxis.get_minor_ticks()) == expected_num
+    assert len(ax.xaxis.get_minorticklabels()) == expected_num
+    assert len(ax.xaxis.get_minorticklines()) == expected_num*2
+
+    # force a draw to call _update_ticks under the hood
+    fig.canvas.draw()
+    # check that the correct number of ticks report them selves as
+    # visible
+    assert sum(t.get_visible() for t in ax.xaxis.minorTicks) == expected_num