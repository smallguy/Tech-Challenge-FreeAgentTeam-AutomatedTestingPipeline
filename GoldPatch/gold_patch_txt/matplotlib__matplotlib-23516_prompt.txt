# 修复代码生成提示词（实例ID：matplotlib__matplotlib-23516）
## 代码仓库
matplotlib/matplotlib

## 原始问题描述
[Bug]: scatter plot color settings discarded unless c given
### Bug summary

When making an animation of a scatter plot, if you don't set `c` (the color value parameter) when initializing the artist, the color settings are ignored.

### Code for reproduction

```python
import matplotlib.animation as animation
import matplotlib.pyplot as plt
import numpy as np

fig, ax = plt.subplots()
pts = ax.scatter([], [], cmap="gray")
ax.set_xlim(0, 1)
ax.set_ylim(0, 1)

def update(i):
    pts.set_offsets(np.random.rand(100, 2))
    pts.set_array(np.random.rand(100))

ani = animation.FuncAnimation(fig, func=update, frames=range(10))
plt.show()
```


### Actual outcome

Even though `cmap="gray"` is passed to `scatter`, the points use the default "viridis" color map.

### Expected outcome

I would expect the points to use the "gray" color map.

### Additional information

If you modify the above code to use:
```python
pts = ax.scatter([], [], c=[], cmap="gray")
```
it works as expected. It seems like all color-related settings, including cmap, vmin, vmax, etc. are discarded unless `c` is given during the first call to `scatter`. 

This workaround (passing an empty `c`) isn't problematic, but I found the default behavior quite unintuitive and it took me the better part of a day to figure out what was happening, so I figured it would be worth reporting.

Possible solutions:

* Raise an error/warning if `cmap`/`vmin`/`vmax` are given but `c` is not
* Store parameters like `cmap`/`vmin`/`vmax` even if they aren't immediately used

These changes should probably happen in `_parse_scatter_color_args` in `lib/matplotlib/axes/_axes.py`. According to `git blame`, @timhoffm @anntzer wrote most of this logic.

### Operating system

macOS 12.4

### Matplotlib Version

3.5.2

### Matplotlib Backend

MacOSX

### Python version

3.9.13

### Jupyter version

N/A

### Installation

from source (.tar.gz)


## 参考黄金补丁（正确的修复方案）
diff --git a/lib/matplotlib/tests/test_axes.py b/lib/matplotlib/tests/test_axes.py
--- a/lib/matplotlib/tests/test_axes.py
+++ b/lib/matplotlib/tests/test_axes.py
@@ -2383,6 +2383,25 @@ def test_scatter_color(self):
         with pytest.raises(ValueError):
             plt.scatter([1, 2, 3], [1, 2, 3], color=[1, 2, 3])
 
+    @pytest.mark.parametrize('kwargs',
+                                [
+                                    {'cmap': 'gray'},
+                                    {'norm': mcolors.Normalize()},
+                                    {'vmin': 0},
+                                    {'vmax': 0}
+                                ])
+    def test_scatter_color_warning(self, kwargs):
+        warn_match = "No data for colormapping provided "
+        # Warn for cases where 'cmap', 'norm', 'vmin', 'vmax'
+        # kwargs are being overridden
+        with pytest.warns(Warning, match=warn_match):
+            plt.scatter([], [], **kwargs)
+        with pytest.warns(Warning, match=warn_match):
+            plt.scatter([1, 2], [3, 4], c=[], **kwargs)
+        # Do not warn for cases where 'c' matches 'x' and 'y'
+        plt.scatter([], [], c=[], **kwargs)
+        plt.scatter([1, 2], [3, 4], c=[4, 5], **kwargs)
+
     def test_scatter_unfilled(self):
         coll = plt.scatter([0, 1, 2], [1, 3, 2], c=['0.1', '0.3', '0.5'],
                            marker=mmarkers.MarkerStyle('o', fillstyle='none'),
diff --git a/lib/matplotlib/tests/test_colorbar.py b/lib/matplotlib/tests/test_colorbar.py
--- a/lib/matplotlib/tests/test_colorbar.py
+++ b/lib/matplotlib/tests/test_colorbar.py
@@ -280,7 +280,7 @@ def test_remove_from_figure(use_gridspec):
     Test `remove` with the specified ``use_gridspec`` setting
     """
     fig, ax = plt.subplots()
-    sc = ax.scatter([1, 2], [3, 4], cmap="spring")
+    sc = ax.scatter([1, 2], [3, 4])
     sc.set_array(np.array([5, 6]))
     pre_position = ax.get_position()
     cb = fig.colorbar(sc, use_gridspec=use_gridspec)
@@ -296,7 +296,7 @@ def test_remove_from_figure_cl():
     Test `remove` with constrained_layout
     """
     fig, ax = plt.subplots(constrained_layout=True)
-    sc = ax.scatter([1, 2], [3, 4], cmap="spring")
+    sc = ax.scatter([1, 2], [3, 4])
     sc.set_array(np.array([5, 6]))
     fig.draw_without_rendering()
     pre_position = ax.get_position()