# 修复代码生成提示词（实例ID：matplotlib__matplotlib-22815）
## 代码仓库
matplotlib/matplotlib

## 原始问题描述
[Bug]: make_norm_from_scale should create picklable classes even when used in-line.
### Bug summary

The new `matplotlib.colors.make_norm_from_scale` helper dynamically generates a norm class from a scale class.  Currently, in the codebase, it is only used as a decorator to create "toplevel" classes (e.g., it is used to generate LogNorm from LogScale, etc.), but it can also be used within other functions to dynamically generate a norm class based on a user-given arbitrary scale (see #20752 for an example of application, which is however not necessary to understand for what follows).  In the latter case, the dynamically generate class is currently not picklable (because pickling of classes relies on the existence of global names, see e.g. ["classes are pickled by named reference"](https://docs.python.org/3/library/pickle.html#what-can-be-pickled-and-unpickled )).  It would be generally useful to get rid of this restriction, which can be done by implementing the [`__reduce__` protocol](https://docs.python.org/3/library/pickle.html#object.__reduce__); there's already other examples in the codebase of dynamically generated classes that use the same mechanism).

I'm tagging this as "good first issue" because there's no API design and the eng goal is clear, but medium (perhaps hard) difficulty because it requires somewhat sophisticated understanding of the details of the pickling process.

### Code for reproduction

```python
pickle.dumps(matplotlib.colors.make_norm_from_scale(matplotlib.scale.LogitScale, matplotlib.colors.Normalize))
```


### Actual outcome

```
Can't pickle <class 'matplotlib.colors.Normalize'>: it's not the same object as matplotlib.colors.Normalize
```
(Note the additional confusion here: there's two classes that are both named `matplotlib.colors.Normalize` -- the original one and the dynamically generated one -- but they are different.)

### Expected outcome

A correct round-trippable pickle.

### Operating system

_No response_

### Matplotlib Version

master (unreleased, pre 3.5)

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Other libraries

_No response_

### Installation

source

### Conda channel

_No response_


## 参考黄金补丁（正确的修复方案）
diff --git a/lib/matplotlib/tests/test_pickle.py b/lib/matplotlib/tests/test_pickle.py
--- a/lib/matplotlib/tests/test_pickle.py
+++ b/lib/matplotlib/tests/test_pickle.py
@@ -221,6 +221,11 @@ def test_mpl_toolkits():
     assert type(pickle.loads(pickle.dumps(ax))) == parasite_axes.HostAxes
 
 
+def test_standard_norm():
+    assert type(pickle.loads(pickle.dumps(mpl.colors.LogNorm()))) \
+        == mpl.colors.LogNorm
+
+
 def test_dynamic_norm():
     logit_norm_instance = mpl.colors.make_norm_from_scale(
         mpl.scale.LogitScale, mpl.colors.Normalize)()