# 修复代码生成提示词（实例ID：matplotlib__matplotlib-24924）
## 代码仓库
matplotlib/matplotlib

## 原始问题描述
[Bug]: Cannot toggle set_tight_layout
### Bug summary

As of #20426 calling `Figure.set_tight_layout(False)` does not disable the tight layout algorithm. 

### Code for reproduction

```python
from matplotlib import pyplot as plt

fig, ax = plt.subplots()
fig.set_tight_layout(True)
fig.set_tight_layout(False)
assert not fig.get_tight_layout()
```


### Actual outcome

AssertionError

### Expected outcome

clean exit

### Additional information

I'm pretty sure [this branch](https://github.com/matplotlib/matplotlib/blob/88371856684ee5ca12a04a084354d8592e49386e/lib/matplotlib/figure.py#L2502-L2503) just needs to set `self.set_layout_engine(None)` in the falsey case.  Attn: @jklymak 

### Operating system

_No response_

### Matplotlib Version

main

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Installation

_No response_


## 参考黄金补丁（正确的修复方案）
diff --git a/lib/matplotlib/tests/test_constrainedlayout.py b/lib/matplotlib/tests/test_constrainedlayout.py
--- a/lib/matplotlib/tests/test_constrainedlayout.py
+++ b/lib/matplotlib/tests/test_constrainedlayout.py
@@ -667,3 +667,14 @@ def test_compressed1():
 def test_set_constrained_layout(arg, state):
     fig, ax = plt.subplots(constrained_layout=arg)
     assert fig.get_constrained_layout() is state
+
+
+def test_constrained_toggle():
+    fig, ax = plt.subplots()
+    with pytest.warns(PendingDeprecationWarning):
+        fig.set_constrained_layout(True)
+        assert fig.get_constrained_layout()
+        fig.set_constrained_layout(False)
+        assert not fig.get_constrained_layout()
+        fig.set_constrained_layout(True)
+        assert fig.get_constrained_layout()
diff --git a/lib/matplotlib/tests/test_tightlayout.py b/lib/matplotlib/tests/test_tightlayout.py
--- a/lib/matplotlib/tests/test_tightlayout.py
+++ b/lib/matplotlib/tests/test_tightlayout.py
@@ -380,3 +380,14 @@ def test_tight_pads():
 def test_tight_kwargs():
     fig, ax = plt.subplots(tight_layout={'pad': 0.15})
     fig.draw_without_rendering()
+
+
+def test_tight_toggle():
+    fig, ax = plt.subplots()
+    with pytest.warns(PendingDeprecationWarning):
+        fig.set_tight_layout(True)
+        assert fig.get_tight_layout()
+        fig.set_tight_layout(False)
+        assert not fig.get_tight_layout()
+        fig.set_tight_layout(True)
+        assert fig.get_tight_layout()