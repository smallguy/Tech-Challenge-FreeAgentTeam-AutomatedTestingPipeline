# 修复代码生成提示词（实例ID：django__django-14030）
## 代码仓库
django/django

## 原始问题描述
Admin never_cache decorators needs method_decorator
Description
	
The login and logout views in Django's admin site are using the never_cache decorator, but they are both instance methods, so they need to use the method_decorator.
This is not a bug because the never_cache decorator is only operating on the response. The first argument to the decorator is supposed to be the request, but it is in-fact the admin_site instance (self). All the arguments are then passed to the view function and the decorator operate on the response.
If you try to use a different decorator that uses the request (such as required_http_methods) you will fail. 
AttributeError: 'CustomAdminSite' object has no attribute 'method'
Related issue from long time ago:
https://code.djangoproject.com/ticket/18923


## 参考黄金补丁（正确的修复方案）
diff --git a/tests/decorators/tests.py b/tests/decorators/tests.py
--- a/tests/decorators/tests.py
+++ b/tests/decorators/tests.py
@@ -470,7 +470,7 @@ def a_view(request):
         self.assertIsNone(r.get('X-Frame-Options', None))
 
 
-class NeverCacheDecoratorTest(TestCase):
+class NeverCacheDecoratorTest(SimpleTestCase):
     def test_never_cache_decorator(self):
         @never_cache
         def a_view(request):
@@ -480,3 +480,30 @@ def a_view(request):
             set(r.headers['Cache-Control'].split(', ')),
             {'max-age=0', 'no-cache', 'no-store', 'must-revalidate', 'private'},
         )
+
+    def test_never_cache_decorator_http_request(self):
+        class MyClass:
+            @never_cache
+            def a_view(self, request):
+                return HttpResponse()
+        msg = (
+            "never_cache didn't receive an HttpRequest. If you are decorating "
+            "a classmethod, be sure to use @method_decorator."
+        )
+        with self.assertRaisesMessage(TypeError, msg):
+            MyClass().a_view(HttpRequest())
+
+
+class CacheControlDecoratorTest(SimpleTestCase):
+    def test_cache_control_decorator_http_request(self):
+        class MyClass:
+            @cache_control(a='b')
+            def a_view(self, request):
+                return HttpResponse()
+
+        msg = (
+            "cache_control didn't receive an HttpRequest. If you are "
+            "decorating a classmethod, be sure to use @method_decorator."
+        )
+        with self.assertRaisesMessage(TypeError, msg):
+            MyClass().a_view(HttpRequest())