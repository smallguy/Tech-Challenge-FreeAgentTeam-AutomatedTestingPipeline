# 修复代码生成提示词（实例ID：django__django-13814）
## 代码仓库
django/django

## 原始问题描述
Raising InvalidTemplateLibrary completely masks out real exception in get_package_libraries
Description
	
Summary
In django/template/backends/django.py, function get_package_libraries on line 119 completely masks out the ImportError and raises InvalidTemplateLibrary. This makes it incredibly difficult to debug application issues.
Probably better not to handle the exception in the first place since it only raises another type and inner exception looses the stack trace.
To reproduce
Create two apps e.g. form_utils and reports. 
Write a template tag in reports e.g. reports.templatetags.report_tags. (reports/templatetags/report_tags.py
Add a simple module in form_utils e.g. widgets.py. 
In widgets.py, import a none-existent module e.g. from django.forms.util import flatatt (was removed in > django 1.4)
import form_utils.widget in report_tags e.g. from form_utils.widgets import CalendarWidget
A quick way to reproduce the error would be to register some models with admin and navigate to /admin
The following error will be raised in get_package_libraries:
InvalidTemplateLibrary at /admin/login/
Invalid template library specified. ImportError raised when trying to load 'reports.templatetags.report_tags': No module named util
Request Method:		 GET
Request URL:		 ​http://localhost:2017/admin/login/?next=/admin/
Django Version:		 1.10.1
Exception Type:		 InvalidTemplateLibrary
Exception Value:		 
Invalid template library specified. ImportError raised when trying to load 'reports.templatetags.report_tags': No module named util
Exception Location:		 D:\repo\django110\lib\site-packages\django\template\backends\django.py in get_package_libraries, line 130
However, if the exception was not caught and "wrongly" re-raised as an InvalidTemplateLibrary, the following errors would be printed:
ImportError at /admin/login/
No module named util
Request Method:		 GET
Request URL:		 ​http://localhost:2017/admin/login/?next=/admin/
Django Version:		 1.10.1
Exception Type:		 ImportError
Exception Value:		 
No module named util
Exception Location:		 D:\repo\projects\evincehr\apps\form_utils\widgets.py in <module>, line 3
The second behavior is more appropriate to debugging the error and the error would be quickly found.


## 参考黄金补丁（正确的修复方案）
diff --git a/tests/template_backends/test_django.py b/tests/template_backends/test_django.py
--- a/tests/template_backends/test_django.py
+++ b/tests/template_backends/test_django.py
@@ -104,13 +104,14 @@ def test_templatetag_discovery_import_error(self):
             InvalidTemplateLibrary,
             "ImportError raised when trying to load "
             "'template_backends.apps.importerror.templatetags.broken_tags'"
-        ):
+        ) as cm:
             DjangoTemplates({
                 'DIRS': [],
                 'APP_DIRS': False,
                 'NAME': 'django',
                 'OPTIONS': {},
             })
+        self.assertIsInstance(cm.exception.__cause__, ImportError)
 
     def test_builtins_discovery(self):
         engine = DjangoTemplates({