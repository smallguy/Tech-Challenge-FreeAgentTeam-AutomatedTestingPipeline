# 修复代码生成提示词（实例ID：sphinx-doc__sphinx-9261）
## 代码仓库
sphinx-doc/sphinx

## 原始问题描述
Building autodocs for derived classes produces invalid warnings
**Describe the bug**
Generating API docs using the autodoc extensions, when a base class has doc strings in the constructor as well as in the class definition, and the autoclass_content feature is set to "both", produces superfluous warnings when parsing derived classes with overloaded constructors with no doc strings on them. 

**To Reproduce**
1. Create a base class with a constructor, and provide both a class doc string and a constructor doc string, something like this:

```
class MyBase:
    """Base class docstring"""

    def __init__(self, fubar):
        """
        Args:
            fubar (str):
                parameter description here
        """
```

2. Create a derived class that has an overloaded constructor, with no doc string, something like this:
```
class MyDerived(MyBase):
    def __init__(self):
        pass
```

3. Enable the auto content option in Sphinx to combine the class doc string and constructor doc strings together (ie: `autoclass_content = "both"` in the conf.py script)

4. Attempt to generate the docs using the apidoc extension (ie: when using sphinxcontrib.apidoc, just run `sphinx-build docs/ htmldocs/`)


**Expected behavior**
Expected behavior: the API docs for both the base and derived classes should be generated without warnings.
Actual behavior: docs for the base class generate correctly, but docs for the derived class produce the following warning
"docstring of sample.MyDerived: WARNING: Unexpected indentation." 


**Environment info**
- OS: MacOS 11.3.1 (reproducible on several other Linux / Mac systems)
- Python version: 3.6.8 (reproducible on several newer versions as well)
- Sphinx version: 4.0.1 (reproducible on versions as far back as v2.2.0)
- Sphinx extensions:  sphinx.ext.autodoc,sphinx.ext.napoleon
- Extra tools: (optional) sphinxcontrib.apidoc



## 参考黄金补丁（正确的修复方案）
diff --git a/tests/test_util_inspect.py b/tests/test_util_inspect.py
--- a/tests/test_util_inspect.py
+++ b/tests/test_util_inspect.py
@@ -674,7 +674,10 @@ def func1(a, b, c):
 def test_getdoc_inherited_decorated_method():
     class Foo:
         def meth(self):
-            """docstring."""
+            """
+            docstring
+                indented text
+            """
 
     class Bar(Foo):
         @functools.lru_cache()
@@ -683,7 +686,7 @@ def meth(self):
             pass
 
     assert inspect.getdoc(Bar.meth, getattr, False, Bar, "meth") is None
-    assert inspect.getdoc(Bar.meth, getattr, True, Bar, "meth") == "docstring."
+    assert inspect.getdoc(Bar.meth, getattr, True, Bar, "meth") == Foo.meth.__doc__
 
 
 def test_is_builtin_class_method():