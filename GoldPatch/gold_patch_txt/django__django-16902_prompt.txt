# 修复代码生成提示词（实例ID：django__django-16902）
## 代码仓库
django/django

## 原始问题描述
Right() function on Oracle and SQLite returns improper value when the length is zero.
Description
	
Hi
I have found that the RIGHT database function on Oracle returns the whole string instead of empty string when the given length is 0. You can't explicitly give 0 to the RIGHT function, but it may be computed by the database. Basic example (you can use any model with a CharField):
from django.db.models.functions import Right, Length
MyModel.objects.annotate(suffix=Right("foo", Length("foo") - Length("foo")))
On PostgreSQL this will return an empty string under the field suffix, but on Oracle this will return the whole contents of the field foo. This is because Django uses the SUBSTR function on Oracle by multiplying the given length value by -1 and giving it as a position argument. I think it is not intended behavior and it should return the empty string as PostgreSQL does. Or at least be documented as a Note in the Right function documentation.


## 参考黄金补丁（正确的修复方案）
diff --git a/tests/db_functions/text/test_right.py b/tests/db_functions/text/test_right.py
--- a/tests/db_functions/text/test_right.py
+++ b/tests/db_functions/text/test_right.py
@@ -1,5 +1,6 @@
+from django.db import connection
 from django.db.models import IntegerField, Value
-from django.db.models.functions import Lower, Right
+from django.db.models.functions import Length, Lower, Right
 from django.test import TestCase
 
 from ..models import Author
@@ -26,6 +27,21 @@ def test_invalid_length(self):
         with self.assertRaisesMessage(ValueError, "'length' must be greater than 0"):
             Author.objects.annotate(raises=Right("name", 0))
 
+    def test_zero_length(self):
+        Author.objects.create(name="Tom", alias="tom")
+        authors = Author.objects.annotate(
+            name_part=Right("name", Length("name") - Length("alias"))
+        )
+        self.assertQuerySetEqual(
+            authors.order_by("name"),
+            [
+                "mith",
+                "" if connection.features.interprets_empty_strings_as_nulls else None,
+                "",
+            ],
+            lambda a: a.name_part,
+        )
+
     def test_expressions(self):
         authors = Author.objects.annotate(
             name_part=Right("name", Value(3, output_field=IntegerField()))