# 修复代码生成提示词（实例ID：matplotlib__matplotlib-23332）
## 代码仓库
matplotlib/matplotlib

## 原始问题描述
Certain non-hashable parameters to text() give cryptic error messages
<!--To help us understand and resolve your issue, please fill out the form to the best of your ability.-->
<!--You can feel free to delete the sections that do not apply.-->

### Bug report

**Bug summary**

Per the title.  See https://discourse.matplotlib.org/t/cryptic-exception-when-axes-parameters-are-not-as-expected/ as well.

**Code for reproduction**

<!--A minimum code snippet required to reproduce the bug.
Please make sure to minimize the number of dependencies required, and provide
any necessary plotted data.
Avoid using threads, as Matplotlib is (explicitly) not thread-safe.-->

```python
figtext(.5, .5, "foo", rotation=[90])
# or
figtext(.5, .5, "foo", transform_rotates_text=[0])
# or
figtext(.5, .5, "foo", linespacing=[0])
```
all fail with
```
TypeError: unhashable type: 'list'
```

**Actual outcome**

see above

**Expected outcome**

Error out in the setter instead.

**Matplotlib version**
<!--Please specify your platform and versions of the relevant libraries you are using:-->
  * Operating system: linux
  * Matplotlib version: (`import matplotlib; print(matplotlib.__version__)`): master
  * Matplotlib backend (`print(matplotlib.get_backend())`): any
  * Python version: 38
  * Jupyter version (if applicable):
  * Other libraries: 

<!--Please tell us how you installed matplotlib and python e.g., from source, pip, conda-->
<!--If you installed from conda, please specify which channel you used if not the default-->




## 参考黄金补丁（正确的修复方案）
diff --git a/lib/matplotlib/tests/test_text.py b/lib/matplotlib/tests/test_text.py
--- a/lib/matplotlib/tests/test_text.py
+++ b/lib/matplotlib/tests/test_text.py
@@ -519,8 +519,8 @@ def test_two_2line_texts(spacing1, spacing2):
     fig = plt.figure()
     renderer = fig.canvas.get_renderer()
 
-    text1 = plt.text(0.25, 0.5, text_string, linespacing=spacing1)
-    text2 = plt.text(0.25, 0.5, text_string, linespacing=spacing2)
+    text1 = fig.text(0.25, 0.5, text_string, linespacing=spacing1)
+    text2 = fig.text(0.25, 0.5, text_string, linespacing=spacing2)
     fig.canvas.draw()
 
     box1 = text1.get_window_extent(renderer=renderer)
@@ -534,6 +534,11 @@ def test_two_2line_texts(spacing1, spacing2):
         assert box1.height != box2.height
 
 
+def test_validate_linespacing():
+    with pytest.raises(TypeError):
+        plt.text(.25, .5, "foo", linespacing="abc")
+
+
 def test_nonfinite_pos():
     fig, ax = plt.subplots()
     ax.text(0, np.nan, 'nan')