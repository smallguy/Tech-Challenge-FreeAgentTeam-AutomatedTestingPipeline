# 修复代码生成提示词（实例ID：scikit-learn__scikit-learn-13017）
## 代码仓库
scikit-learn/scikit-learn

## 原始问题描述
ColumnTransformer behavior for negative column indexes
<!--
If your issue is a usage question, submit it here instead:
- StackOverflow with the scikit-learn tag: https://stackoverflow.com/questions/tagged/scikit-learn
- Mailing List: https://mail.python.org/mailman/listinfo/scikit-learn
For more information, see User Questions: http://scikit-learn.org/stable/support.html#user-questions
-->

<!-- Instructions For Filing a Bug: https://github.com/scikit-learn/scikit-learn/blob/master/CONTRIBUTING.md#filing-bugs -->

#### Description
The behavior of `ColumnTransformer` when negative integers are passed as column indexes is not clear.

#### Steps/Code to Reproduce

```python
import numpy as np
from sklearn.compose import ColumnTransformer
from sklearn.preprocessing import OneHotEncoder

X = np.random.randn(2, 2)
X_categories = np.array([[1], [2]])
X = np.concatenate([X, X_categories], axis=1)

print('---- With negative index ----')
ohe = OneHotEncoder(categories='auto')
tf_1 = ColumnTransformer([('ohe', ohe, [-1])], remainder='passthrough')
print(tf_1.fit_transform(X))

print('---- With positive index ----')
tf_2 = ColumnTransformer([('ohe', ohe, [2])], remainder='passthrough')
print(tf_2.fit_transform(X))
```

#### Expected Results
The first transformer `tf_1` should either raise an error or give the same result as the second transformer `tf_2`

#### Actual Results
```python-tb
---- With negative index ----
[[ 1.          0.          0.10600662 -0.46707426  1.        ]
 [ 0.          1.         -1.33177629  2.29186299  2.        ]]
---- With positive index ----
[[ 1.          0.          0.10600662 -0.46707426]
 [ 0.          1.         -1.33177629  2.29186299]]
```


## 参考黄金补丁（正确的修复方案）
diff --git a/sklearn/compose/tests/test_column_transformer.py b/sklearn/compose/tests/test_column_transformer.py
--- a/sklearn/compose/tests/test_column_transformer.py
+++ b/sklearn/compose/tests/test_column_transformer.py
@@ -1019,3 +1019,15 @@ def func(X):
     assert_array_equal(ct.fit(X_df).transform(X_df), X_res_first)
     assert callable(ct.transformers[0][2])
     assert ct.transformers_[0][2] == ['first']
+
+
+def test_column_transformer_negative_column_indexes():
+    X = np.random.randn(2, 2)
+    X_categories = np.array([[1], [2]])
+    X = np.concatenate([X, X_categories], axis=1)
+
+    ohe = OneHotEncoder(categories='auto')
+
+    tf_1 = ColumnTransformer([('ohe', ohe, [-1])], remainder='passthrough')
+    tf_2 = ColumnTransformer([('ohe', ohe,  [2])], remainder='passthrough')
+    assert_array_equal(tf_1.fit_transform(X), tf_2.fit_transform(X))