# 修复代码生成提示词（实例ID：matplotlib__matplotlib-24088）
## 代码仓库
matplotlib/matplotlib

## 原始问题描述
[Bug]: ValueError: Unable to determine Axes to steal space for Colorbar.
### Bug summary

`matplotlib==3.6.0` started raising an error when trying to add a colorbar to `plt.hist()`:

ValueError: Unable to determine Axes to steal space for Colorbar. Either provide the *cax* argument to use as the Axes for the Colorbar, provide the *ax* argument to steal space from it, or add *mappable* to an Axes.

### Code for reproduction

```python
import matplotlib.pyplot as plt
import numpy as np

xs = np.random.rand(100)

_, bin_edges, bars = plt.hist(xs)
color_map = getattr(plt.cm, "hot")
for x_val, rect in zip(bin_edges, bars.patches):
    rect.set_color(color_map(x_val))

cbar = plt.colorbar(
    plt.cm.ScalarMappable(cmap=color_map),
    # cax=ax.inset_axes([0.95, 0.1, 0.05, 0.8]),
)
```

### Actual outcome

In `matplotlib==3.6.0`:

![mpl==3 6 0](https://user-images.githubusercontent.com/30958850/191547778-033472e7-e739-4beb-a1f4-eecdcb587e22.png)


### Expected outcome

In `matplotlib==3.5.1`:

![mpl==3 5 1](https://user-images.githubusercontent.com/30958850/191547733-cd4911a5-67c8-4070-a708-ce3399e8c0ba.png)

### Operating system

macOS 12.6

### Matplotlib Version

3.6.0

### Python version

3.10

### Installation

pip


## 参考黄金补丁（正确的修复方案）
diff --git a/lib/matplotlib/tests/test_colorbar.py b/lib/matplotlib/tests/test_colorbar.py
--- a/lib/matplotlib/tests/test_colorbar.py
+++ b/lib/matplotlib/tests/test_colorbar.py
@@ -1,10 +1,12 @@
 import numpy as np
 import pytest
 
+from matplotlib import _api
 from matplotlib import cm
 import matplotlib.colors as mcolors
 import matplotlib as mpl
 
+
 from matplotlib import rc_context
 from matplotlib.testing.decorators import image_comparison
 import matplotlib.pyplot as plt
@@ -319,7 +321,8 @@ def test_parentless_mappable():
     pc = mpl.collections.PatchCollection([], cmap=plt.get_cmap('viridis'))
     pc.set_array([])
 
-    with pytest.raises(ValueError, match='Unable to determine Axes to steal'):
+    with pytest.warns(_api.MatplotlibDeprecationWarning,
+                      match='Unable to determine Axes to steal'):
         plt.colorbar(pc)