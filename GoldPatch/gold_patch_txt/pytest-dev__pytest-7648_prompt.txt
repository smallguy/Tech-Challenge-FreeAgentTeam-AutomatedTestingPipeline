# 修复代码生成提示词（实例ID：pytest-dev__pytest-7648）
## 代码仓库
pytest-dev/pytest

## 原始问题描述
Since pytest 6.0.0, pylint complains about unimplemented abstract methods in custom collector
Hi, we have implemented a custom pytest collector that takes testcases from YAML files. Starting with pytest 6.0.0, pylint reports the following about that collector:

```
tests/functiontest/conftest.py:225:0: W0223: Method 'get_closest_marker' is abstract in class 'Node' but is not overridden (abstract-method)
tests/functiontest/conftest.py:225:0: W0223: Method 'gethookproxy' is abstract in class 'FSCollector' but is not overridden (abstract-method)
tests/functiontest/conftest.py:225:0: W0223: Method 'isinitpath' is abstract in class 'FSCollector' but is not overridden (abstract-method)
tests/functiontest/conftest.py:252:0: W0223: Method 'get_closest_marker' is abstract in class 'Node' but is not overridden (abstract-method)
```
The collector has worked fine for a long time, and it still works fine.

The line pylint reports this on is the class definition of a collector class that is based on pytest.File:

```
class YamlFile(pytest.File):

    def collect(self):  # The only method in this class
        . . . 
```
The whole source code is here: https://github.com/pywbem/pywbem/blob/master/tests/functiontest/conftest.py#L225

Versions:

Python 3.8.0 (default, Oct 15 2019, 17:49:23). This happens on all Python 3.x versions we used pytest 6.0.1 with (3.5, 3.6, 3.7, 3.8), on macOS and Ubuntu.

pylint 2.4.4
astroid 2.3.3

platform linux -- Python 3.8.0, pytest-6.0.1, py-1.9.0, pluggy-0.13.1
plugins: cov-2.10.0, yagot-0.5.0, requests-mock-1.8.0

Please let me know in case a collector has to implement these methods.


## 参考黄金补丁（正确的修复方案）
diff --git a/testing/deprecated_test.py b/testing/deprecated_test.py
--- a/testing/deprecated_test.py
+++ b/testing/deprecated_test.py
@@ -1,11 +1,13 @@
 import copy
 import inspect
+import warnings
 from unittest import mock
 
 import pytest
 from _pytest import deprecated
 from _pytest import nodes
 from _pytest.config import Config
+from _pytest.pytester import Testdir
 
 
 @pytest.mark.filterwarnings("default")
@@ -151,3 +153,28 @@ def test_three(): assert 1
     )
     result = testdir.runpytest("-k", "test_two:", threepass)
     result.stdout.fnmatch_lines(["*The `-k 'expr:'` syntax*deprecated*"])
+
+
+def test_fscollector_gethookproxy_isinitpath(testdir: Testdir) -> None:
+    module = testdir.getmodulecol(
+        """
+        def test_foo(): pass
+        """,
+        withinit=True,
+    )
+    assert isinstance(module, pytest.Module)
+    package = module.parent
+    assert isinstance(package, pytest.Package)
+
+    with pytest.warns(pytest.PytestDeprecationWarning, match="gethookproxy"):
+        package.gethookproxy(testdir.tmpdir)
+
+    with pytest.warns(pytest.PytestDeprecationWarning, match="isinitpath"):
+        package.isinitpath(testdir.tmpdir)
+
+    # The methods on Session are *not* deprecated.
+    session = module.session
+    with warnings.catch_warnings(record=True) as rec:
+        session.gethookproxy(testdir.tmpdir)
+        session.isinitpath(testdir.tmpdir)
+    assert len(rec) == 0