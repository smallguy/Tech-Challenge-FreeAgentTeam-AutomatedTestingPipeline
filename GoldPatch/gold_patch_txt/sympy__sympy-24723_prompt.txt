# 修复代码生成提示词（实例ID：sympy__sympy-24723）
## 代码仓库
sympy/sympy

## 原始问题描述
Stats: Matrix Normal Distribution returns wrong probability density function
As explained on the [Wikipedia page](https://en.wikipedia.org/wiki/Matrix_normal_distribution), the PDF of Matrix Normal Distribution is as follows: 

![image](https://user-images.githubusercontent.com/96943731/218960673-dd1df75e-8130-4c1c-847a-57e5178cdef2.png)

When initializing a matrix Normal Distribution in Sympy with simple parameters (as mentioned in the docs), the PDF you get is:

```
>>> from sympy import MatrixSymbol
>>> from sympy.stats import density, MatrixNormal
>>> M = MatrixNormal('M', [[1, 2]], [1], [[1, 0], [0, 1]])
>>> X = MatrixSymbol('X', 1, 2)
>>> density(M)(X).doit()

       ⎛⎛⎡-1⎤    T⎞                ⎞
   -tr ⎜⎜⎢  ⎥ + X ⎟ ⋅([-1  -2] + X)⎟
       ⎝⎝⎣-2⎦     ⎠                ⎠
    ────────────────────────────────
                  2
2ℯ
 ───────────────────────────────────
                 π

```


Whereas the actual PDF should be:

```

       ⎛⎛⎡-1⎤    T⎞                ⎞
   -tr ⎜⎜⎢  ⎥ + X ⎟ ⋅([-1  -2] + X)⎟
       ⎝⎝⎣-2⎦     ⎠                ⎠
   ────────────────────────────────
                  2
ℯ
───────────────────────────────────
                 2π

```
References:
https://en.wikipedia.org/wiki/Matrix_normal_distribution
The difference is in the constant of the PDF and should be a simple issue to solve.


## 参考黄金补丁（正确的修复方案）
diff --git a/sympy/stats/tests/test_matrix_distributions.py b/sympy/stats/tests/test_matrix_distributions.py
--- a/sympy/stats/tests/test_matrix_distributions.py
+++ b/sympy/stats/tests/test_matrix_distributions.py
@@ -79,16 +79,16 @@ def test_MatrixNormal():
     X = MatrixSymbol('X', 1, 2)
     term1 = exp(-Trace(Matrix([[ S(2)/3, -S(1)/3], [-S(1)/3, S(2)/3]])*(
             Matrix([[-5], [-6]]) + X.T)*Matrix([[S(1)/4]])*(Matrix([[-5, -6]]) + X))/2)
-    assert density(M)(X).doit() == term1/(24*pi)
-    assert density(M)([[7, 8]]).doit() == exp(-S(1)/3)/(24*pi)
+    assert density(M)(X).doit() == (sqrt(3)) * term1/(24*pi)
+    assert density(M)([[7, 8]]).doit() == sqrt(3)*exp(-S(1)/3)/(24*pi)
     d, n = symbols('d n', positive=True, integer=True)
     SM2 = MatrixSymbol('SM2', d, d)
     SM1 = MatrixSymbol('SM1', n, n)
     LM = MatrixSymbol('LM', n, d)
     Y = MatrixSymbol('Y', n, d)
     M = MatrixNormal('M', LM, SM1, SM2)
-    exprd = 4*(2*pi)**(-d*n/2)*exp(-Trace(SM2**(-1)*(-LM.T + Y.T)*SM1**(-1)*(-LM + Y)
-        )/2)*Determinant(SM1)**(-d)*Determinant(SM2)**(-n)
+    exprd = (2*pi)**(-d*n/2)*exp(-Trace(SM2**(-1)*(-LM.T + Y.T)*SM1**(-1)*(-LM + Y)
+        )/2)*Determinant(SM1)**(-d/2)*Determinant(SM2)**(-n/2)
     assert density(M)(Y).doit() == exprd
     raises(ValueError, lambda: density(M)(1))
     raises(ValueError, lambda: MatrixNormal('M', [1, 2], [[1, 0], [0, 1]], [[1, 0], [2, 1]]))