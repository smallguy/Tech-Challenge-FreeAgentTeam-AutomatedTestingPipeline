# 修复代码生成提示词（实例ID：django__django-14071）
## 代码仓库
django/django

## 原始问题描述
Admin's raw_id_field check admin.E002 doesn't catch .attname mis-references
Description
	
Since admin.E002 relies on models.Options.get_field which allows retrieval of fields by both name and attname referring to fields by attname while only name ​is taken into consideration allows the check to pass while raw_id_fields is not honoured.
e.g.
class BookAdmin(ModelAdmin):
	raw_id_fields = ['author_id']
passes admin.E002 but the author field won't use the raw_id feature.
The _check_raw_id_fields_item method should also make sure to check field.name == field_name on field retrieval success and return refer_to_missing_field(field=field_name, option=label, obj=obj, id='admin.E002') when it's not the case.


## 参考黄金补丁（正确的修复方案）
diff --git a/tests/admin_checks/tests.py b/tests/admin_checks/tests.py
--- a/tests/admin_checks/tests.py
+++ b/tests/admin_checks/tests.py
@@ -309,7 +309,7 @@ class SongAdmin(admin.ModelAdmin):
         self.assertEqual(SongAdmin(Song, AdminSite()).check(), [
             checks.Error(
                 "The value of 'list_editable[0]' refers to 'test', which is "
-                "not an attribute of 'admin_checks.Song'.",
+                "not a field of 'admin_checks.Song'.",
                 obj=SongAdmin,
                 id='admin.E121',
             )
@@ -618,7 +618,7 @@ class RawIdNonexistentAdmin(admin.ModelAdmin):
         expected = [
             checks.Error(
                 "The value of 'raw_id_fields[0]' refers to 'nonexistent', "
-                "which is not an attribute of 'admin_checks.Album'.",
+                "which is not a field of 'admin_checks.Album'.",
                 obj=RawIdNonexistentAdmin,
                 id='admin.E002',
             )
diff --git a/tests/modeladmin/test_checks.py b/tests/modeladmin/test_checks.py
--- a/tests/modeladmin/test_checks.py
+++ b/tests/modeladmin/test_checks.py
@@ -63,7 +63,7 @@ class TestModelAdmin(ModelAdmin):
         self.assertIsInvalid(
             TestModelAdmin, ValidationTestModel,
             "The value of 'raw_id_fields[0]' refers to 'non_existent_field', "
-            "which is not an attribute of 'modeladmin.ValidationTestModel'.",
+            "which is not a field of 'modeladmin.ValidationTestModel'.",
             'admin.E002'
         )
 
@@ -84,6 +84,18 @@ class TestModelAdmin(ModelAdmin):
 
         self.assertIsValid(TestModelAdmin, ValidationTestModel)
 
+    def test_field_attname(self):
+        class TestModelAdmin(ModelAdmin):
+            raw_id_fields = ['band_id']
+
+        self.assertIsInvalid(
+            TestModelAdmin,
+            ValidationTestModel,
+            "The value of 'raw_id_fields[0]' refers to 'band_id', which is "
+            "not a field of 'modeladmin.ValidationTestModel'.",
+            'admin.E002',
+        )
+
 
 class FieldsetsCheckTests(CheckTestCase):
 
@@ -278,7 +290,7 @@ class TestModelAdmin(ModelAdmin):
         self.assertIsInvalid(
             TestModelAdmin, ValidationTestModel,
             "The value of 'filter_vertical[0]' refers to 'non_existent_field', "
-            "which is not an attribute of 'modeladmin.ValidationTestModel'.",
+            "which is not a field of 'modeladmin.ValidationTestModel'.",
             'admin.E019'
         )
 
@@ -318,7 +330,7 @@ class TestModelAdmin(ModelAdmin):
         self.assertIsInvalid(
             TestModelAdmin, ValidationTestModel,
             "The value of 'filter_horizontal[0]' refers to 'non_existent_field', "
-            "which is not an attribute of 'modeladmin.ValidationTestModel'.",
+            "which is not a field of 'modeladmin.ValidationTestModel'.",
             'admin.E019'
         )
 
@@ -359,7 +371,7 @@ class TestModelAdmin(ModelAdmin):
         self.assertIsInvalid(
             TestModelAdmin, ValidationTestModel,
             "The value of 'radio_fields' refers to 'non_existent_field', "
-            "which is not an attribute of 'modeladmin.ValidationTestModel'.",
+            "which is not a field of 'modeladmin.ValidationTestModel'.",
             'admin.E022'
         )
 
@@ -421,7 +433,7 @@ class TestModelAdmin(ModelAdmin):
         self.assertIsInvalid(
             TestModelAdmin, ValidationTestModel,
             "The value of 'prepopulated_fields' refers to 'non_existent_field', "
-            "which is not an attribute of 'modeladmin.ValidationTestModel'.",
+            "which is not a field of 'modeladmin.ValidationTestModel'.",
             'admin.E027'
         )
 
@@ -432,7 +444,7 @@ class TestModelAdmin(ModelAdmin):
         self.assertIsInvalid(
             TestModelAdmin, ValidationTestModel,
             "The value of 'prepopulated_fields[\"slug\"][0]' refers to 'non_existent_field', "
-            "which is not an attribute of 'modeladmin.ValidationTestModel'.",
+            "which is not a field of 'modeladmin.ValidationTestModel'.",
             'admin.E030'
         )
 
@@ -873,7 +885,7 @@ class TestModelAdmin(ModelAdmin):
         self.assertIsInvalid(
             TestModelAdmin, ValidationTestModel,
             "The value of 'ordering[0]' refers to 'non_existent_field', "
-            "which is not an attribute of 'modeladmin.ValidationTestModel'.",
+            "which is not a field of 'modeladmin.ValidationTestModel'.",
             'admin.E033'
         )
 
@@ -914,7 +926,7 @@ class TestModelAdmin(ModelAdmin):
         self.assertIsInvalid(
             TestModelAdmin, ValidationTestModel,
             "The value of 'ordering[0]' refers to 'nonexistent', which is not "
-            "an attribute of 'modeladmin.ValidationTestModel'.",
+            "a field of 'modeladmin.ValidationTestModel'.",
             'admin.E033'
         )
 
@@ -1342,7 +1354,7 @@ class Admin(ModelAdmin):
             Admin, ValidationTestModel,
             msg=(
                 "The value of 'autocomplete_fields[0]' refers to 'nonexistent', "
-                "which is not an attribute of 'modeladmin.ValidationTestModel'."
+                "which is not a field of 'modeladmin.ValidationTestModel'."
             ),
             id='admin.E037',
             invalid_obj=Admin,