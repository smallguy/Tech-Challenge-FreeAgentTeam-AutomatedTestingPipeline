# 修复代码生成提示词（实例ID：pydata__xarray-5580）
## 代码仓库
pydata/xarray

## 原始问题描述
Increase default `display_max_rows`
This must have been introduced into `xr.set_options()` somewhere around version 0.17.
First of all this limit breaks backwards compatibility in the output format with `print()` or something similar on the console. Second, the default of 12 is much too low imo and makes no sense, in particular since terminals usually have a scrollback buffer and notebook cells can be made scrollable.

I use `print()` frequently to check that **all** variables made it into the data set correctly, which is meaningless when lines are skipped with this default limit. And it broke my doctests that I wrote to do exactly that (thanks for that btw.). So if not removed, could the default be at least increased to a sensible number like 100 or 1000 or 10000? (I'd personally prefer much higher or even no limit, but I guess that is not an option.)

Cheers.


## 参考黄金补丁（正确的修复方案）
diff --git a/xarray/tests/test_formatting.py b/xarray/tests/test_formatting.py
--- a/xarray/tests/test_formatting.py
+++ b/xarray/tests/test_formatting.py
@@ -509,15 +509,16 @@ def test__mapping_repr(display_max_rows, n_vars, n_attr):
     long_name = "long_name"
     a = np.core.defchararray.add(long_name, np.arange(0, n_vars).astype(str))
     b = np.core.defchararray.add("attr_", np.arange(0, n_attr).astype(str))
+    c = np.core.defchararray.add("coord", np.arange(0, n_vars).astype(str))
     attrs = {k: 2 for k in b}
-    coords = dict(time=np.array([0, 1]))
+    coords = {_c: np.array([0, 1]) for _c in c}
     data_vars = dict()
-    for v in a:
+    for (v, _c) in zip(a, coords.items()):
         data_vars[v] = xr.DataArray(
             name=v,
             data=np.array([3, 4]),
-            dims=["time"],
-            coords=coords,
+            dims=[_c[0]],
+            coords=dict([_c]),
         )
     ds = xr.Dataset(data_vars)
     ds.attrs = attrs
@@ -525,25 +526,37 @@ def test__mapping_repr(display_max_rows, n_vars, n_attr):
     with xr.set_options(display_max_rows=display_max_rows):
 
         # Parse the data_vars print and show only data_vars rows:
-        summary = formatting.data_vars_repr(ds.data_vars).split("\n")
+        summary = formatting.dataset_repr(ds).split("\n")
         summary = [v for v in summary if long_name in v]
-
         # The length should be less than or equal to display_max_rows:
         len_summary = len(summary)
         data_vars_print_size = min(display_max_rows, len_summary)
         assert len_summary == data_vars_print_size
 
+        summary = formatting.data_vars_repr(ds.data_vars).split("\n")
+        summary = [v for v in summary if long_name in v]
+        # The length should be equal to the number of data variables
+        len_summary = len(summary)
+        assert len_summary == n_vars
+
+        summary = formatting.coords_repr(ds.coords).split("\n")
+        summary = [v for v in summary if "coord" in v]
+        # The length should be equal to the number of data variables
+        len_summary = len(summary)
+        assert len_summary == n_vars
+
     with xr.set_options(
         display_expand_coords=False,
         display_expand_data_vars=False,
         display_expand_attrs=False,
     ):
         actual = formatting.dataset_repr(ds)
+        coord_s = ", ".join([f"{c}: {len(v)}" for c, v in coords.items()])
         expected = dedent(
             f"""\
             <xarray.Dataset>
-            Dimensions:      (time: 2)
-            Coordinates: (1)
+            Dimensions:      ({coord_s})
+            Coordinates: ({n_vars})
             Data variables: ({n_vars})
             Attributes: ({n_attr})"""
         )