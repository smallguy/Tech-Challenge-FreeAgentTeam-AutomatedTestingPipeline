# 修复代码生成提示词（实例ID：django__django-12503）
## 代码仓库
django/django

## 原始问题描述
makemessages doesn't provide feedback when no locale is specified
Description
	 
		(last modified by Cristóbal Mackenzie)
	 
makemessages requires that one of three flags be passed to specify locales for message building: --locale to explicitly specify locales, --exclude to specify locales to exclude, or --all to build message files for all locales.
When non of these flags are present, the command doesn't show any errors for the user. According to the source code, it should raise CommandError, but that never happens because of a bug in an if statement that checks if a locale has been specified.
I've already fixed this in my fork and have submitted a small PR.
​https://github.com/django/django/pull/12503
Please point out if there are any other necessary steps to move this forward. Thanks!


## 参考黄金补丁（正确的修复方案）
diff --git a/tests/i18n/test_extraction.py b/tests/i18n/test_extraction.py
--- a/tests/i18n/test_extraction.py
+++ b/tests/i18n/test_extraction.py
@@ -142,6 +142,16 @@ def test_use_i18n_false(self):
             self.assertIn('#. Translators: One-line translator comment #1', po_contents)
             self.assertIn('msgctxt "Special trans context #1"', po_contents)
 
+    def test_no_option(self):
+        # One of either the --locale, --exclude, or --all options is required.
+        msg = "Type 'manage.py help makemessages' for usage information."
+        with mock.patch(
+            'django.core.management.commands.makemessages.sys.argv',
+            ['manage.py', 'makemessages'],
+        ):
+            with self.assertRaisesRegex(CommandError, msg):
+                management.call_command('makemessages')
+
     def test_comments_extractor(self):
         management.call_command('makemessages', locale=[LOCALE], verbosity=0)
         self.assertTrue(os.path.exists(self.PO_FILE))