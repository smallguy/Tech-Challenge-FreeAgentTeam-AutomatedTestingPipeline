# 修复代码生成提示词（实例ID：sympy__sympy-13346）
## 代码仓库
sympy/sympy

## 原始问题描述
Test failures on non-NumPy environment
Following tests fail on where NumPy is not installed:

```
_______________________________________________________________________________________________________________________
__________________________ sympy\concrete\tests\test_sums_products.py:test_evalf_fast_series __________________________
  File "c:\users\wisec\documents\github\sympy\sympy\concrete\tests\test_sums_products.py", line 334, in test_evalf_fast_series
    4*n)*(1103 + 26390*n)/fac(n)**4/396**(4*n), (n, 0, oo)), 100) == pistr
AssertionError
_______________________________________________________________________________________________________________________
____________________ sympy\concrete\tests\test_sums_products.py:test_evalf_fast_series_issue_4021 _____________________
  File "c:\users\wisec\documents\github\sympy\sympy\concrete\tests\test_sums_products.py", line 355, in test_evalf_fast_series_issue_4021
    NS(Catalan, 100)
AssertionError
_______________________________________________________________________________________________________________________
_______________________________ sympy\integrals\tests\test_quadrature.py:test_legendre ________________________________
  File "c:\users\wisec\documents\github\sympy\sympy\integrals\tests\test_quadrature.py", line 36, in test_legendre
    '0.86113631159405258']
AssertionError
_______________________________________________________________________________________________________________________
_______________________________ sympy\integrals\tests\test_quadrature.py:test_laguerre ________________________________
  File "c:\users\wisec\documents\github\sympy\sympy\integrals\tests\test_quadrature.py", line 73, in test_laguerre
    '6.2899450829374792',
AssertionError
_______________________________________________________________________________________________________________________
___________________________ sympy\integrals\tests\test_quadrature.py:test_laguerre_precise ____________________________
  File "c:\users\wisec\documents\github\sympy\sympy\integrals\tests\test_quadrature.py", line 113, in test_laguerre_precise
    '6.289945082937479196866415765512131657493']
AssertionError
_______________________________________________________________________________________________________________________
________________________________ sympy\integrals\tests\test_quadrature.py:test_hermite ________________________________
  File "c:\users\wisec\documents\github\sympy\sympy\integrals\tests\test_quadrature.py", line 148, in test_hermite
    '1.6506801238857846']
AssertionError
_______________________________________________________________________________________________________________________
_____________________________ sympy\integrals\tests\test_quadrature.py:test_gen_laguerre ______________________________
  File "c:\users\wisec\documents\github\sympy\sympy\integrals\tests\test_quadrature.py", line 199, in test_gen_laguerre
    '5.5253437422632603']
AssertionError
_______________________________________________________________________________________________________________________
_________________________ sympy\integrals\tests\test_quadrature.py:test_gen_laguerre_precise __________________________
  File "c:\users\wisec\documents\github\sympy\sympy\integrals\tests\test_quadrature.py", line 285, in test_gen_laguerre_precise
    '5.525343742263260275941422110422329464413']
AssertionError
_______________________________________________________________________________________________________________________
________________________________ sympy\integrals\tests\test_quadrature.py:test_jacobi _________________________________
  File "c:\users\wisec\documents\github\sympy\sympy\integrals\tests\test_quadrature.py", line 443, in test_jacobi
    '0.90096886790241913']
AssertionError
_______________________________________________________________________________________________________________________
____________________________ sympy\integrals\tests\test_quadrature.py:test_jacobi_precise _____________________________
  File "c:\users\wisec\documents\github\sympy\sympy\integrals\tests\test_quadrature.py", line 529, in test_jacobi_precise
    '0.9009688679024191262361023195074450511659']
AssertionError
_______________________________________________________________________________________________________________________
__________________________ sympy\polys\tests\test_rootoftools.py:test_CRootOf_eval_rational ___________________________
  File "c:\users\wisec\documents\github\sympy\sympy\polys\tests\test_rootoftools.py", line 297, in test_CRootOf_eval_rational
    "0.86113631159405258",
AssertionError
```
Temporarily fixed by #13196:
```
_______________________________________________________________________________________________________________________
___________________________________ sympy\utilities\tests\test_lambdify.py:test_sin ___________________________________
  File "c:\users\wisec\documents\github\sympy\sympy\utilities\tests\test_lambdify.py", line 305, in test_sin
    assert isinstance(f(2), float)
AssertionError
```


Following doctest fails:

```
_______________________________________________________________________________________________________________________
_______________________________________ sympy.matrices.matrices.DeferredVector ________________________________________
File "c:\users\wisec\documents\github\sympy\sympy\matrices\matrices.py", line 51, in sympy.matrices.matrices.DeferredVector
Failed example:
    func( [1, 2, 3] )
Expected:
    (3, 6)
Got:
    (3.0, 6.0)
```


## 参考黄金补丁（正确的修复方案）
diff --git a/sympy/utilities/tests/test_lambdify.py b/sympy/utilities/tests/test_lambdify.py
--- a/sympy/utilities/tests/test_lambdify.py
+++ b/sympy/utilities/tests/test_lambdify.py
@@ -302,7 +302,7 @@ def test_math():
 
 def test_sin():
     f = lambdify(x, sin(x)**2)
-    assert isinstance(f(2), (float, mpmath.ctx_mp_python.mpf))
+    assert isinstance(f(2), float)
     f = lambdify(x, sin(x)**2, modules="math")
     assert isinstance(f(2), float)
 
@@ -390,10 +390,6 @@ def test_issue9474():
         f = lambdify(x, floor(sympy.S(1)/x), modules=mod)
         assert f(2) == 0
 
-    if mpmath:
-        f = lambdify(x, sympy.S(1)/sympy.Abs(x), modules=['mpmath'])
-        assert isinstance(f(2), mpmath.mpf)
-
     for absfunc, modules in product([Abs, abs], mods):
         f = lambdify(x, absfunc(x), modules=modules)
         assert f(-1) == 1