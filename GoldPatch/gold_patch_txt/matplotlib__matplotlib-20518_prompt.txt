# 修复代码生成提示词（实例ID：matplotlib__matplotlib-20518）
## 代码仓库
matplotlib/matplotlib

## 原始问题描述
Sketch params ignored when using PGF backend
### Bug report

**Bug summary**
Calls to `set_sketch_params()` are ignored by the PGF backend and do not have any influence in the resulting pgf or pdf file.

**Code for reproduction**

```python
#!/usr/bin/env python3
import matplotlib as mpl
import matplotlib.pyplot as plt
mpl.use("pgf")

mpl.rcParams.update({
    'font.family': 'serif',
    'text.usetex': True,
    'pgf.rcfonts': False,
    'pgf.preamble': [ 
            # enable this when using PGF backend with pdf output:
            #r"\usepackage{pgf}",
            #r"\usepgfmodule{decorations}",
            #r"\usepgflibrary{decorations.pathmorphing}",
        ],
})

fig = plt.figure()
ax = fig.add_subplot(111)
ax.plot(range(10))

ax.spines["bottom"].set_sketch_params(scale=5, length=10, randomness=42)

fig.savefig(f"foo.pgf")
#fig.savefig(f"foo.pdf")
```

**Actual outcome**
![grafik](https://user-images.githubusercontent.com/37397269/123399005-6ae9eb80-d5a4-11eb-9da8-c05b9d0efa96.png)

**Expected outcome**
![grafik](https://user-images.githubusercontent.com/37397269/123399084-7e955200-d5a4-11eb-976e-03ae3d5b2275.png)


**Matplotlib version**
<!--Please specify your platform and versions of the relevant libraries you are using:-->
  * Matplotlib version: '3.0.2'

I am working on a fix for this.


## 参考黄金补丁（正确的修复方案）
diff --git a/lib/matplotlib/tests/test_backend_pgf.py b/lib/matplotlib/tests/test_backend_pgf.py
--- a/lib/matplotlib/tests/test_backend_pgf.py
+++ b/lib/matplotlib/tests/test_backend_pgf.py
@@ -337,3 +337,30 @@ def test_minus_signs_with_tex(fig_test, fig_ref, texsystem):
     mpl.rcParams["pgf.texsystem"] = texsystem
     fig_test.text(.5, .5, "$-1$")
     fig_ref.text(.5, .5, "$\N{MINUS SIGN}1$")
+
+
+@pytest.mark.backend("pgf")
+def test_sketch_params():
+    fig, ax = plt.subplots(figsize=(3, 3))
+    ax.set_xticks([])
+    ax.set_yticks([])
+    ax.set_frame_on(False)
+    handle, = ax.plot([0, 1])
+    handle.set_sketch_params(scale=5, length=30, randomness=42)
+
+    with BytesIO() as fd:
+        fig.savefig(fd, format='pgf')
+        buf = fd.getvalue().decode()
+
+    baseline = r"""\pgfpathmoveto{\pgfqpoint{0.375000in}{0.300000in}}%
+\pgfpathlineto{\pgfqpoint{2.700000in}{2.700000in}}%
+\usepgfmodule{decorations}%
+\usepgflibrary{decorations.pathmorphing}%
+\pgfkeys{/pgf/decoration/.cd, """ \
+    r"""segment length = 0.150000in, amplitude = 0.100000in}%
+\pgfmathsetseed{42}%
+\pgfdecoratecurrentpath{random steps}%
+\pgfusepath{stroke}%"""
+    # \pgfdecoratecurrentpath must be after the path definition and before the
+    # path is used (\pgfusepath)
+    assert baseline in buf