# 修复代码生成提示词（实例ID：sphinx-doc__sphinx-8028）
## 代码仓库
sphinx-doc/sphinx

## 原始问题描述
Instance attributes are omitted with autosummary
This issue is a followup of #7948. Sorry, I forgot to open it.

**Is your feature request related to a problem? Please describe.**
Instance attributes are omitted when using the autosummary, as they cannot be imported. Consider the following class

```python
# contents of test_mod.py

class Test:
    """Test class"""

    #: int. Some class attribute
    test: int = 1

    def __init__(self, a: int):
        #: int. An instance attribute
        self.a = 1

```

`autodoc` via 

```rst
.. autoclass:: Test
    :members:
``` 

will document the `a` attribute, but `autosummary` via

```rst
.. autosummary::

    Test.a
    Test.test
```
won't.

**Describe the solution you'd like**
Instance attributes should be documented, too

**Describe alternatives you've considered**
it did work before 1dcfc44, i.e. for `sphinx<3.1` (although the documentation was omitted).

**Additional context**

- #7948
- files to reproduce the issue (including page build) [test.zip](https://github.com/sphinx-doc/sphinx/files/4982157/test.zip)
- Screenshot of index.html
  ![image](https://user-images.githubusercontent.com/9960249/88545154-ddf88400-d01a-11ea-906c-193e39fbb4d3.png)




## 参考黄金补丁（正确的修复方案）
diff --git a/tests/roots/test-ext-autosummary/autosummary_dummy_module.py b/tests/roots/test-ext-autosummary/autosummary_dummy_module.py
--- a/tests/roots/test-ext-autosummary/autosummary_dummy_module.py
+++ b/tests/roots/test-ext-autosummary/autosummary_dummy_module.py
@@ -16,7 +16,8 @@ class Bar:
         pass
 
     def __init__(self):
-        pass
+        #: docstring
+        self.value = 1
 
     def bar(self):
         pass
diff --git a/tests/roots/test-ext-autosummary/index.rst b/tests/roots/test-ext-autosummary/index.rst
--- a/tests/roots/test-ext-autosummary/index.rst
+++ b/tests/roots/test-ext-autosummary/index.rst
@@ -10,6 +10,7 @@
    autosummary_dummy_module
    autosummary_dummy_module.Foo
    autosummary_dummy_module.Foo.Bar
+   autosummary_dummy_module.Foo.value
    autosummary_dummy_module.bar
    autosummary_dummy_module.qux
    autosummary_importfail
diff --git a/tests/test_ext_autosummary.py b/tests/test_ext_autosummary.py
--- a/tests/test_ext_autosummary.py
+++ b/tests/test_ext_autosummary.py
@@ -293,15 +293,17 @@ def test_autosummary_generate(app, status, warning):
                                                                                nodes.row,
                                                                                nodes.row,
                                                                                nodes.row,
+                                                                               nodes.row,
                                                                                nodes.row)])])
     assert_node(doctree[4][0], addnodes.toctree, caption="An autosummary")
 
-    assert len(doctree[3][0][0][2]) == 5
+    assert len(doctree[3][0][0][2]) == 6
     assert doctree[3][0][0][2][0].astext() == 'autosummary_dummy_module\n\n'
     assert doctree[3][0][0][2][1].astext() == 'autosummary_dummy_module.Foo()\n\n'
     assert doctree[3][0][0][2][2].astext() == 'autosummary_dummy_module.Foo.Bar()\n\n'
-    assert doctree[3][0][0][2][3].astext() == 'autosummary_dummy_module.bar(x[, y])\n\n'
-    assert doctree[3][0][0][2][4].astext() == 'autosummary_dummy_module.qux\n\na module-level attribute'
+    assert doctree[3][0][0][2][3].astext() == 'autosummary_dummy_module.Foo.value\n\ndocstring'
+    assert doctree[3][0][0][2][4].astext() == 'autosummary_dummy_module.bar(x[, y])\n\n'
+    assert doctree[3][0][0][2][5].astext() == 'autosummary_dummy_module.qux\n\na module-level attribute'
 
     module = (app.srcdir / 'generated' / 'autosummary_dummy_module.rst').read_text()
     assert ('   .. autosummary::\n'
@@ -333,6 +335,11 @@ def test_autosummary_generate(app, status, warning):
             '\n'
             '.. autoclass:: Foo.Bar\n' in FooBar)
 
+    Foo_value = (app.srcdir / 'generated' / 'autosummary_dummy_module.Foo.value.rst').read_text()
+    assert ('.. currentmodule:: autosummary_dummy_module\n'
+            '\n'
+            '.. autoattribute:: Foo.value' in Foo_value)
+
     qux = (app.srcdir / 'generated' / 'autosummary_dummy_module.qux.rst').read_text()
     assert ('.. currentmodule:: autosummary_dummy_module\n'
             '\n'