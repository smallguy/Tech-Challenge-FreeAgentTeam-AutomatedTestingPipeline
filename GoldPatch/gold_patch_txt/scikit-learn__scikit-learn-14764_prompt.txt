# 修复代码生成提示词（实例ID：scikit-learn__scikit-learn-14764）
## 代码仓库
scikit-learn/scikit-learn

## 原始问题描述
datasets :: make_classification() weights parameter should be a sequence (not just a list). 
### `weights` should be passed as list or array (not just list) in `sklearn\datasets\samples_generator.py :: make_classification`:
 If there is a pertinent reason that `weights` must be a list, while *all other iterable parameters are arrays*, then it should be mentioned in the docstring. Otherwise, the docstring should be amended as in `make_blobs`, e.g.  "weights : list of floats or None (default=None)" -> "weights : sequence of floats or None (default=None)", along with amended lines 165 and 171 (see Corrections).

#### Test code to reproduce:
``` 
print('Testing weights type in `datasets.make_classification`:')
# using defaults except for weights (& random_state=1):

w = [0.25, 0.75]
print('  Test 1: weights as List {}'.format(w))
X, y = make_classification(weights=w, random_state=1)
print('  Test 1 result: len(X)={}, len(y)={}'.format(len(X),len(y)))

w = np.array([0.25, 0.75]) 
print('  Test 2: weights as np.array {}'.format(w))
X, y = make_classification(weights=w, random_state=1)
print('  Test 2 result: len(X)={}, len(y)={}, '.format(len(X),len(y)))
```
#### Expected Results:
Should not fail: np.array as valid as a list:
```
Testing weights type in `make_classification`:
  Test 1: weights as List [0.25, 0.75]
  Test 1 result: len(X)=100, len(y)=100
  Test 2: weights as np.array [0.25, 0.75]
  Test 2 result: len(X)=100, len(y)=100
```

#### Actual Results
```
Testing weights type in `make_classification`:
  Test 1: weights as List [0.25, 0.75]
  Test 1 result: len(X)=100, len(y)=100
  Test 2: weights as np.array [0.25, 0.75]
```
```error
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-2-c297f465db24> in <module>
     13 print('  Test 2: weights as np.array {}'.format(w))
     14 X, y = make_classification(weights=w,
---> 15                            random_state=1)
     16 print('  Test 2 result: len(X)={}, len(y)={}, '.format(len(X),len(y)))

~\Anaconda3\envs\dsml\lib\site-packages\sklearn\datasets\samples_generator.py in make_classification(n_samples, n_features, n_informative, n_redundant, n_repeated, n_classes, n_clusters_per_class, weights, flip_y, class_sep, hypercube, shift, scale, shuffle, random_state)
    163         raise ValueError("n_classes * n_clusters_per_class must"
    164                          " be smaller or equal 2 ** n_informative")
--> 165     if weights and len(weights) not in [n_classes, n_classes - 1]:
    166         raise ValueError("Weights specified but incompatible with number "
    167                          "of classes.")

ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
```

#### Corrections needed (fix ready):
```
165     if all(weights) and (len(weights) not in [n_classes, n_classes - 1]):

171     if all(weights) and len(weights) == (n_classes - 1):
```

#### Versions:
```  
    System:
    python: 3.6.7 (default, Feb 28 2019, 07:28:18) [MSC v.1900 64 bit (AMD64)]
executable: C:\<conda env path>\python.exe
   machine: Windows-10-10.0.18362-SP0 [same outcome with Windows-10-10.0.17134-SP0]

Python deps:
       pip: 19.1.1
setuptools: 41.0.1
   sklearn: 0.21.3
     numpy: 1.16.4
     scipy: 1.3.0
    Cython: None
    pandas: 0.24.2
```
#wimlds
[MRG] Added an example to the sklearn.feature_extraction.image.PatchExtractor
…or class

<!--
Thanks for contributing a pull request! Please ensure you have taken a look at
the contribution guidelines: https://github.com/scikit-learn/scikit-learn/blob/master/CONTRIBUTING.md#pull-request-checklist
-->

#### Reference Issues/PRs
<!--
Contributes to #3846.

-->


#### What does this implement/fix? Explain your changes.
I added an example to the sklearn.feature_extraction.image.PatchExtractor (#3846)

#### Any other comments?


<!--
Please be aware that we are a loose team of volunteers so patience is
necessary; assistance handling other issues is very welcome. We value
all user contributions, no matter how minor they are. If we are slow to
review, either the pull request needs some benchmarking, tinkering,
convincing, etc. or more likely the reviewers are simply busy. In either
case, we ask for your understanding during the review process.
For more information, see our FAQ on this topic:
http://scikit-learn.org/dev/faq.html#why-is-my-pull-request-not-getting-any-attention.

Thanks for contributing!
-->



## 参考黄金补丁（正确的修复方案）
diff --git a/sklearn/datasets/tests/test_samples_generator.py b/sklearn/datasets/tests/test_samples_generator.py
--- a/sklearn/datasets/tests/test_samples_generator.py
+++ b/sklearn/datasets/tests/test_samples_generator.py
@@ -146,6 +146,36 @@ def test_make_classification_informative_features():
              n_clusters_per_class=2)
 
 
+@pytest.mark.parametrize(
+    'weights, err_type, err_msg',
+    [
+        ([], ValueError,
+         "Weights specified but incompatible with number of classes."),
+        ([.25, .75, .1], ValueError,
+         "Weights specified but incompatible with number of classes."),
+        (np.array([]), ValueError,
+         "Weights specified but incompatible with number of classes."),
+        (np.array([.25, .75, .1]), ValueError,
+         "Weights specified but incompatible with number of classes."),
+        (np.random.random(3), ValueError,
+         "Weights specified but incompatible with number of classes.")
+    ]
+)
+def test_make_classification_weights_type(weights, err_type, err_msg):
+    with pytest.raises(err_type, match=err_msg):
+        make_classification(weights=weights)
+
+
+@pytest.mark.parametrize("kwargs", [{}, {"n_classes": 3, "n_informative": 3}])
+def test_make_classification_weights_array_or_list_ok(kwargs):
+    X1, y1 = make_classification(weights=[.1, .9],
+                                 random_state=0, **kwargs)
+    X2, y2 = make_classification(weights=np.array([.1, .9]),
+                                 random_state=0, **kwargs)
+    assert_almost_equal(X1, X2)
+    assert_almost_equal(y1, y2)
+
+
 def test_make_multilabel_classification_return_sequences():
     for allow_unlabeled, min_length in zip((True, False), (0, 1)):
         X, Y = make_multilabel_classification(n_samples=100, n_features=20,