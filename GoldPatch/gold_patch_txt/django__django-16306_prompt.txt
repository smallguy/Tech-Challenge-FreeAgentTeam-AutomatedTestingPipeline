# 修复代码生成提示词（实例ID：django__django-16306）
## 代码仓库
django/django

## 原始问题描述
BaseForm.__getitem__() does unneeded work in the happy path
Description
	
I noticed that in the "happy path," BaseForm.__getitem__() does unneeded work: ​https://github.com/django/django/blob/fa35c8bdbc6aca65d94d6280fa463d5bc7baa5c0/django/forms/forms.py#L150-L164
It can just return self._bound_fields_cache[name] at the beginning and handle KeyError, instead of accessing self.fields followed by checking for the presence of name in self._bound_fields_cache before doing so each time.


## 参考黄金补丁（正确的修复方案）
diff --git a/tests/forms_tests/tests/test_forms.py b/tests/forms_tests/tests/test_forms.py
--- a/tests/forms_tests/tests/test_forms.py
+++ b/tests/forms_tests/tests/test_forms.py
@@ -4579,6 +4579,22 @@ def test_label_attrs_not_localized(self):
             '<legend number="9999" for="id_first_name">First name:</legend>',
         )
 
+    def test_remove_cached_field(self):
+        class TestForm(Form):
+            name = CharField(max_length=10)
+
+            def __init__(self, *args, **kwargs):
+                super().__init__(*args, **kwargs)
+                # Populate fields cache.
+                [field for field in self]
+                # Removed cached field.
+                del self.fields["name"]
+
+        f = TestForm({"name": "abcde"})
+
+        with self.assertRaises(KeyError):
+            f["name"]
+
 
 @jinja2_tests
 class Jinja2FormsTestCase(FormsTestCase):