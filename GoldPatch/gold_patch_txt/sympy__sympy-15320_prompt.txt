# 修复代码生成提示词（实例ID：sympy__sympy-15320）
## 代码仓库
sympy/sympy

## 原始问题描述
RootOf might ignore generator
This is related to #8551 but a little different. I'm not sure of all the ramifications but just want to document this.

Note how feeding RootOf an expression in terms of a new generator might ignore that generator if the form of the polynomial is the same

```
>>> RootOf(x**3+x-1,0)
RootOf(x**3 + x - 1, 0)
>>> RootOf((x**3+x-1).subs(x,tan(x)),0)
RootOf(x**3 + x - 1, 0)
>>> _.poly.gen
x  <----------------/!\ When you solve for RootOf values you will be getting tan(x) values
```

```
>>> RootOf(tan(x)**3 + 2*tan(x) - 1, 0)  # a new form
RootOf(tan(x)**3 + 2*tan(x) - 1, 0)
>>> RootOf((x**3+2*x-1),0)  # same form but new generator (x instead of tan(x)
RootOf(tan(x)**3 + 2*tan(x) - 1, 0)  <--------/!\ generator is tan(x) instead of x
>>> _.poly.gen
tan(x)
```



## 参考黄金补丁（正确的修复方案）
diff --git a/sympy/polys/tests/test_polytools.py b/sympy/polys/tests/test_polytools.py
--- a/sympy/polys/tests/test_polytools.py
+++ b/sympy/polys/tests/test_polytools.py
@@ -2500,10 +2500,9 @@ def test_factor_large():
             x**6 - x**5 + x**4 - x**3 + x**2 - x + 1, 1)])
 
 
-@XFAIL
 def test_factor_noeval():
-    assert factor(6*x - 10) == 2*(3*x - 5)
-    assert factor((6*x - 10)/(3*x - 6)) == S(2)/3*((3*x - 5)/(x - 2))
+    assert factor(6*x - 10) == Mul(2, 3*x - 5, evaluate=False)
+    assert factor((6*x - 10)/(3*x - 6)) == Mul(S(2)/3, 3*x - 5, 1/(x - 2))
 
 
 def test_intervals():
diff --git a/sympy/polys/tests/test_rootoftools.py b/sympy/polys/tests/test_rootoftools.py
--- a/sympy/polys/tests/test_rootoftools.py
+++ b/sympy/polys/tests/test_rootoftools.py
@@ -79,8 +79,9 @@ def test_CRootOf___new__():
 
     raises(PolynomialError, lambda: rootof(Poly(0, x), 0))
     raises(PolynomialError, lambda: rootof(Poly(1, x), 0))
-
     raises(PolynomialError, lambda: rootof(x - y, 0))
+    # issue 8617
+    raises(PolynomialError, lambda: rootof(exp(x), 0))
 
     raises(NotImplementedError, lambda: rootof(x**3 - x + sqrt(2), 0))
     raises(NotImplementedError, lambda: rootof(x**3 - x + I, 0))
@@ -237,9 +238,6 @@ def test_CRootOf_evalf():
     # issue 6451
     r = rootof(legendre_poly(64, x), 7)
     assert r.n(2) == r.n(100).n(2)
-    # issue 8617
-    ans = [w.n(2) for w in solve(x**3 - x - 4)]
-    assert rootof(exp(x)**3 - exp(x) - 4, 0).n(2) in ans
     # issue 9019
     r0 = rootof(x**2 + 1, 0, radicals=False)
     r1 = rootof(x**2 + 1, 1, radicals=False)