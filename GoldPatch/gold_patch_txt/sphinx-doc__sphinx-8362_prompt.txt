# 修复代码生成提示词（实例ID：sphinx-doc__sphinx-8362）
## 代码仓库
sphinx-doc/sphinx

## 原始问题描述
autodoc uses a wrapper's signature for a decorated class
**Describe the bug**

`autodoc` uses a wrapper's signature for a decorated class.

**To Reproduce**

Branch: https://github.com/harupy/sphinx/tree/decorated-class

Steps to reproduce the behavior:

In `tests/roots/test-ext-autodoc/target/decorator.py`, add:.

```python

def deco(cls):
    _original_init = cls.__init__

    @wraps(_original_init)
    def wrapped(self, *args, **kwargs):
        _original_init(self, *args, **kwargs)

    cls.__init__ = wrapped
    return cls

@deco
class Bar2:
    def __init__(self, name=None, age=None):
        pass
```

In `tests/test_ext_autodoc.py`, add:

```python
@pytest.mark.sphinx('html', testroot='ext-autodoc')
def test_decorated_class(app):
    print(do_autodoc(app, 'class', 'target.decorator.Bar2'))
    raise Exception  # fails this test to see stdout
```

Then, run:

```
tox -e py37 tests/test_ext_autodoc.py::test_decorated_class
```

This outputs:

```
--- Captured stdout call ---
['', '.. py:class:: Bar2(*args, **kwargs)', '   :module: target.decorator', '']
```

**Expected behavior**
A clear and concise description of what you expected to happen.

```
--- Captured stdout call ---
['', '.. py:class:: Bar2(self, name=None, age=None)', '   :module: target.decorator', '']
```



**Your project**
Link to your sphinx project, or attach zipped small project sample.

**Screenshots**
If applicable, add screenshots to help explain your problem.

**Environment info**
- OS: [e.g. Unix/Linux/Mac/Win/other with version]
- Python version: [e.g. 3.7.1]
- Sphinx version: [e.g. 1.8.2]
- Sphinx extensions:  [e.g. sphinx.ext.autodoc, recommonmark]
- Extra tools: [e.g. Browser, tex or something else]

**Additional context**
Add any other context about the problem here.

- [e.g. URL or Ticket]



## 参考黄金补丁（正确的修复方案）
diff --git a/tests/roots/test-ext-autodoc/target/decorator.py b/tests/roots/test-ext-autodoc/target/decorator.py
--- a/tests/roots/test-ext-autodoc/target/decorator.py
+++ b/tests/roots/test-ext-autodoc/target/decorator.py
@@ -29,3 +29,25 @@ class Bar:
     @deco1
     def meth(self, name=None, age=None):
         pass
+
+
+class Baz:
+    @deco1
+    def __init__(self, name=None, age=None):
+        pass
+
+
+class Qux:
+    @deco1
+    def __new__(self, name=None, age=None):
+        pass
+
+
+class _Metaclass(type):
+    @deco1
+    def __call__(self, name=None, age=None):
+        pass
+
+
+class Quux(metaclass=_Metaclass):
+    pass
diff --git a/tests/test_ext_autodoc_autoclass.py b/tests/test_ext_autodoc_autoclass.py
--- a/tests/test_ext_autodoc_autoclass.py
+++ b/tests/test_ext_autodoc_autoclass.py
@@ -48,3 +48,28 @@ def test_classes(app):
         '',
     ]
 
+
+def test_decorators(app):
+    actual = do_autodoc(app, 'class', 'target.decorator.Baz')
+    assert list(actual) == [
+        '',
+        '.. py:class:: Baz(name=None, age=None)',
+        '   :module: target.decorator',
+        '',
+    ]
+
+    actual = do_autodoc(app, 'class', 'target.decorator.Qux')
+    assert list(actual) == [
+        '',
+        '.. py:class:: Qux(name=None, age=None)',
+        '   :module: target.decorator',
+        '',
+    ]
+
+    actual = do_autodoc(app, 'class', 'target.decorator.Quux')
+    assert list(actual) == [
+        '',
+        '.. py:class:: Quux(name=None, age=None)',
+        '   :module: target.decorator',
+        '',
+    ]
diff --git a/tests/test_util_inspect.py b/tests/test_util_inspect.py
--- a/tests/test_util_inspect.py
+++ b/tests/test_util_inspect.py
@@ -100,7 +100,7 @@ def wrapped_bound_method(*args, **kwargs):
 
     # wrapped bound method
     sig = inspect.signature(wrapped_bound_method)
-    assert stringify_signature(sig) == '(*args, **kwargs)'
+    assert stringify_signature(sig) == '(arg1, **kwargs)'
 
 
 def test_signature_partialmethod():