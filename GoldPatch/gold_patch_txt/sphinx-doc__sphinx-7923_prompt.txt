# 修复代码生成提示词（实例ID：sphinx-doc__sphinx-7923）
## 代码仓库
sphinx-doc/sphinx

## 原始问题描述
Bad refs in pot files, when using rst_epilog
**To Reproduce**
conf.py
```python
rst_epilog = """
.. |var1| replace:: VAR1
"""
```
index.rst
```
A
======

a
   b
```

`make gettext` produces index.pot with bad string numbers and "\<generated\>" refs:
```
#: ../../index.rst:2
msgid "A"
msgstr ""

#: ../../<generated>:1
msgid "a"
msgstr ""

#: ../../index.rst:5
msgid "b"
msgstr ""
```




## 参考黄金补丁（正确的修复方案）
diff --git a/tests/test_parser.py b/tests/test_parser.py
--- a/tests/test_parser.py
+++ b/tests/test_parser.py
@@ -50,7 +50,7 @@ def test_RSTParser_prolog_epilog(RSTStateMachine, app):
     (content, _), _ = RSTStateMachine().run.call_args
     assert list(content.xitems()) == [('dummy.rst', 0, 'hello Sphinx world'),
                                       ('dummy.rst', 1, 'Sphinx is a document generator'),
-                                      ('<generated>', 0, ''),
+                                      ('dummy.rst', 2, ''),
                                       ('<rst_epilog>', 0, 'this is rst_epilog'),
                                       ('<rst_epilog>', 1, 'good-bye reST!')]
 
diff --git a/tests/test_util_rst.py b/tests/test_util_rst.py
--- a/tests/test_util_rst.py
+++ b/tests/test_util_rst.py
@@ -32,7 +32,7 @@ def test_append_epilog(app):
 
     assert list(content.xitems()) == [('dummy.rst', 0, 'hello Sphinx world'),
                                       ('dummy.rst', 1, 'Sphinx is a document generator'),
-                                      ('<generated>', 0, ''),
+                                      ('dummy.rst', 2, ''),
                                       ('<rst_epilog>', 0, 'this is rst_epilog'),
                                       ('<rst_epilog>', 1, 'good-bye reST!')]