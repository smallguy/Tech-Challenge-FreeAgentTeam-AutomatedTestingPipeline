# 修复代码生成提示词（实例ID：sphinx-doc__sphinx-9654）
## 代码仓库
sphinx-doc/sphinx

## 原始问题描述
Incorrect base class detection
### Describe the bug

I have a chain of subclasses, like A -> B -> C -> D. When I document class D, it lists the base class as A instead of C.

### How to Reproduce

```
$ git clone https://github.com/microsoft/torchgeo.git
$ cd torchgeo/docs
$ pip install -r requirements.txt
$ make html
$ # open _build/html/api/datasets.html and see that the base class is torch.utils.data.Dataset instead of RasterDataset
```


### Expected behavior

I would expect the base class to be the direct super class.

### Your project

https://github.com/microsoft/torchgeo

### Screenshots

_No response_

### OS

macOS 10.15.7, Linux (whatever RtD uses)

### Python version

3.8.11

### Sphinx version

4.0.1, 4.0.2

### Sphinx extensions

sphinx.ext.autodoc

### Extra tools

_No response_

### Additional context

I don't think this is the same as #9504 because I can reproduce it with 4.0.1 too.

Could be related to #9395.

For a class like [Landsat](https://github.com/microsoft/torchgeo/blob/main/torchgeo/datasets/landsat.py#L14), even though the super class is `RasterDataset`, the base class is listed as `torch.utils.data.Dataset`.

@calebrob6


## 参考黄金补丁（正确的修复方案）
diff --git a/tests/roots/test-ext-autodoc/target/classes.py b/tests/roots/test-ext-autodoc/target/classes.py
--- a/tests/roots/test-ext-autodoc/target/classes.py
+++ b/tests/roots/test-ext-autodoc/target/classes.py
@@ -29,6 +29,10 @@ class Quux(List[Union[int, float]]):
     pass
 
 
+class Corge(Quux):
+    pass
+
+
 Alias = Foo
 
 #: docstring
diff --git a/tests/test_ext_autodoc_autoclass.py b/tests/test_ext_autodoc_autoclass.py
--- a/tests/test_ext_autodoc_autoclass.py
+++ b/tests/test_ext_autodoc_autoclass.py
@@ -273,6 +273,21 @@ def test_show_inheritance_for_subclass_of_generic_type(app):
     ]
 
 
+@pytest.mark.skipif(sys.version_info < (3, 7), reason='python 3.7+ is required.')
+@pytest.mark.sphinx('html', testroot='ext-autodoc')
+def test_show_inheritance_for_decendants_of_generic_type(app):
+    options = {'show-inheritance': None}
+    actual = do_autodoc(app, 'class', 'target.classes.Corge', options)
+    assert list(actual) == [
+        '',
+        '.. py:class:: Corge(iterable=(), /)',
+        '   :module: target.classes',
+        '',
+        '   Bases: :py:class:`target.classes.Quux`',
+        '',
+    ]
+
+
 @pytest.mark.sphinx('html', testroot='ext-autodoc')
 def test_autodoc_process_bases(app):
     def autodoc_process_bases(app, name, obj, options, bases):