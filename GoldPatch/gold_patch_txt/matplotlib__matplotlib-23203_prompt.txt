# 修复代码生成提示词（实例ID：matplotlib__matplotlib-23203）
## 代码仓库
matplotlib/matplotlib

## 原始问题描述
[Bug]: colorbar ignores keyword panchor=False
### Bug summary

`colorbar` seems to ignore the keyword setting `panchor=False`

### Code for reproduction

```python
import matplotlib
print('mpl version:', matplotlib.__version__)
import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure(figsize=(5, 8))
ax = fig.add_subplot(1, 1, 1, aspect=0.5, anchor="N")

a = np.arange(12)[:,np.newaxis] * np.ones(8)
levels = np.arange(1.5, 10, 2)

plt.contourf(a, cmap='RdYlBu', levels=levels, extend='both')
print('anchor before colorbar:', ax.get_anchor())
plt.colorbar(orientation='horizontal', panchor=False)
print('anchor after colorbar:', ax.get_anchor())
```


### Actual outcome

```
mpl version: 3.6.0.dev2341+g3df958c760
anchor before colorbar: N
anchor after colorbar: (0.5, 0.0)
```

### Expected outcome

My reading of the [docs](https://matplotlib.org/devdocs/api/_as_gen/matplotlib.pyplot.colorbar.html#matplotlib.pyplot.colorbar) is that the axes anchor should still be "N" after I add the colorbar.  Though given #18752, it's possible I have misunderstood!

> panchor(float, float), or False, optional
> 
> The anchor point of the colorbar parent axes. If False, the parent axes' anchor will be unchanged. Defaults to (1.0, 0.5) if vertical; (0.5, 0.0) if horizontal.


### Additional information

_No response_

### Operating system

_No response_

### Matplotlib Version

`main` branch (3.6.0.dev2341+g3df958c760), 3.5.2 and some older (3.3+) versions.

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Installation

_No response_


## 参考黄金补丁（正确的修复方案）
diff --git a/lib/matplotlib/tests/test_colorbar.py b/lib/matplotlib/tests/test_colorbar.py
--- a/lib/matplotlib/tests/test_colorbar.py
+++ b/lib/matplotlib/tests/test_colorbar.py
@@ -211,11 +211,23 @@ def test_colorbar_positioning(use_gridspec):
 
 
 def test_colorbar_single_ax_panchor_false():
-    # Just smoketesting that this doesn't crash.  Note that this differs from
-    # the tests above with panchor=False because there use_gridspec is actually
-    # ineffective: passing *ax* as lists always disable use_gridspec.
+    # Note that this differs from the tests above with panchor=False because
+    # there use_gridspec is actually ineffective: passing *ax* as lists always
+    # disables use_gridspec.
+    ax = plt.subplot(111, anchor='N')
     plt.imshow([[0, 1]])
     plt.colorbar(panchor=False)
+    assert ax.get_anchor() == 'N'
+
+
+@pytest.mark.parametrize('constrained', [False, True],
+                         ids=['standard', 'constrained'])
+def test_colorbar_single_ax_panchor_east(constrained):
+    fig = plt.figure(constrained_layout=constrained)
+    ax = fig.add_subplot(111, anchor='N')
+    plt.imshow([[0, 1]])
+    plt.colorbar(panchor='E')
+    assert ax.get_anchor() == 'E'
 
 
 @image_comparison(['contour_colorbar.png'], remove_text=True)