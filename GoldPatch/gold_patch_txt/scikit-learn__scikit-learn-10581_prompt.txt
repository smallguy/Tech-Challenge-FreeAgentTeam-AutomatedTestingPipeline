# 修复代码生成提示词（实例ID：scikit-learn__scikit-learn-10581）
## 代码仓库
scikit-learn/scikit-learn

## 原始问题描述
ElasticNet overwrites X even with copy_X=True
The `fit` function of an `ElasticNet`, called with `check_input=False`, overwrites X, even when `copy_X=True`:
```python
import numpy as np
from sklearn.linear_model import ElasticNet


rng = np.random.RandomState(0)
n_samples, n_features = 20, 2
X = rng.randn(n_samples, n_features).copy(order='F')
beta = rng.randn(n_features)
y = 2 + np.dot(X, beta) + rng.randn(n_samples)

X_copy = X.copy()
enet = ElasticNet(fit_intercept=True, normalize=False, copy_X=True)
enet.fit(X, y, check_input=False)

print("X unchanged = ", np.all(X == X_copy))
```
ElasticNet overwrites X even with copy_X=True
The `fit` function of an `ElasticNet`, called with `check_input=False`, overwrites X, even when `copy_X=True`:
```python
import numpy as np
from sklearn.linear_model import ElasticNet


rng = np.random.RandomState(0)
n_samples, n_features = 20, 2
X = rng.randn(n_samples, n_features).copy(order='F')
beta = rng.randn(n_features)
y = 2 + np.dot(X, beta) + rng.randn(n_samples)

X_copy = X.copy()
enet = ElasticNet(fit_intercept=True, normalize=False, copy_X=True)
enet.fit(X, y, check_input=False)

print("X unchanged = ", np.all(X == X_copy))
```
[MRG] FIX #10540 ElasticNet overwrites X even with copy_X=True
Made changes as suggested by @gxyd.
please review and suggest changes @jnothman @gxyd 


## 参考黄金补丁（正确的修复方案）
diff --git a/sklearn/linear_model/tests/test_coordinate_descent.py b/sklearn/linear_model/tests/test_coordinate_descent.py
--- a/sklearn/linear_model/tests/test_coordinate_descent.py
+++ b/sklearn/linear_model/tests/test_coordinate_descent.py
@@ -3,6 +3,7 @@
 # License: BSD 3 clause
 
 import numpy as np
+import pytest
 from scipy import interpolate, sparse
 from copy import deepcopy
 
@@ -669,6 +670,30 @@ def test_check_input_false():
     assert_raises(ValueError, clf.fit, X, y, check_input=False)
 
 
+@pytest.mark.parametrize("check_input", [True, False])
+def test_enet_copy_X_True(check_input):
+    X, y, _, _ = build_dataset()
+    X = X.copy(order='F')
+
+    original_X = X.copy()
+    enet = ElasticNet(copy_X=True)
+    enet.fit(X, y, check_input=check_input)
+
+    assert_array_equal(original_X, X)
+
+
+def test_enet_copy_X_False_check_input_False():
+    X, y, _, _ = build_dataset()
+    X = X.copy(order='F')
+
+    original_X = X.copy()
+    enet = ElasticNet(copy_X=False)
+    enet.fit(X, y, check_input=False)
+
+    # No copying, X is overwritten
+    assert_true(np.any(np.not_equal(original_X, X)))
+
+
 def test_overrided_gram_matrix():
     X, y, _, _ = build_dataset(n_samples=20, n_features=10)
     Gram = X.T.dot(X)